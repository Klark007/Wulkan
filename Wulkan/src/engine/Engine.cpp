#include "Engine.h"

#define VMA_IMPLEMENTATION
#include "vma/vk_mem_alloc.h"

#include <GLFW/glfw3.h>

#include <iostream>

#ifdef NDEBUG
#else
#define PROFILING
#endif

#include "Profiler.h"

void Engine::init(unsigned int w, unsigned int h)
{
	res_x = w;
	res_y = h;

	init_glfw();
	init_vulkan();

	camera = Camera( glm::vec3(0.0, 60.0, 25.0), glm::vec3(0.0, 10.0, 8.0), res_x, res_y, glm::radians(45.0f), 0.1f, 100.0f );
	camera_controller = CameraController(window, &camera);
	gui.init(window, instance, device, graphics_queue, imgui_descriptor_pool, &swapchain, &camera_controller);
	cleanup_queue.add(&gui);
 }

Engine::~Engine()
{
	for (unsigned int i = 0; i < MAX_FRAMES_IN_FLIGHT; i++) {
		VK_DESTROY(sync_structs.at(i).swapchain_semaphore, vkDestroySemaphore, device, sync_structs.at(i).swapchain_semaphore);
		VK_DESTROY(sync_structs.at(i).render_semaphore, vkDestroySemaphore, device, sync_structs.at(i).render_semaphore);
		VK_DESTROY(sync_structs.at(i).render_fence, vkDestroyFence, device, sync_structs.at(i).render_fence);
	}

	cleanup_queue.del_all_obj();

	glfwDestroyWindow(window);
	glfwTerminate();
}

void Engine::run()
{
	camera_controller.init_time();

	while (!glfwWindowShouldClose(window)) {
		update();

		if (aquire_image()) {
			draw();

			present();

			late_update();
		}

		if (resize_window) {
			recreate_swapchain();
			resize_window = false;
		}

	}

	vkDeviceWaitIdle(device);
}


void Engine::update()
{
	glfwPollEvents();

	camera_controller.update_time();
	camera_controller.handle_keys();

	gui_input = gui.get_input();

	camera_controller.set_move_strength(gui_input.camera_movement_speed);
	camera_controller.set_rotation_strength(gui_input.camera_rotation_speed);

	terrain.set_tesselation_strength(gui_input.terrain_tesselation);
	terrain.set_max_tesselation(gui_input.max_terrain_tesselation);
	terrain.set_model_matrix(
		glm::scale(glm::mat4(1), glm::vec3(25.0, 25.0, 25.0 * gui_input.terrain_height_scale))
	);
	terrain.set_texture_eps(gui_input.terrain_texture_eps);
	terrain.set_visualization_mode(gui_input.terrain_vis_mode);

	directional_light.set_direction(glm::normalize(gui_input.sun_direction));

	update_uniforms();
}

void Engine::draw()
{
	// shadow pass		
	{
		// TODO: Use camera controllers active camera
		int nr_cascades = gui_input.nr_shadow_cascades;
		directional_light.set_uniforms(camera, nr_cascades, current_frame);


		const VKW_CommandBuffer& shadow_cmd = directional_light.begin_depth_pass(current_frame);
		{
			// draw using depth only pipelines
			{
				VKW_GraphicsPipeline& pipeline = terrain_depth_pipeline;
				pipeline.set_render_size(directional_light.get_texture().get_extent());

				for (uint32_t i = 0; i < nr_cascades; i++) {
					pipeline.set_depth_attachment(
						directional_light.get_texture().get_image_view(VK_IMAGE_ASPECT_DEPTH_BIT, VK_IMAGE_VIEW_TYPE_2D, i, 1),
						true,
						1.0f
					);

					pipeline.begin_rendering(shadow_cmd);
					{
						pipeline.bind(shadow_cmd);
						pipeline.set_dynamic_state(shadow_cmd);
						pipeline.set_depth_bias(gui_input.depth_bias, gui_input.slope_depth_bias, shadow_cmd);

						terrain.set_cascade_idx(i);
						terrain.draw(shadow_cmd, current_frame, pipeline);
					}
					pipeline.end_rendering(shadow_cmd);
				}
			}
		}
		directional_light.end_depth_pass(current_frame);
	}

	{

		const VKW_CommandBuffer& cmd = get_current_command_buffer();
		cmd.reset(); // resetting command pool might be more efficient

		// begin command buffer
		cmd.begin();
	
		{
			// initial layout transitions
			Texture::transition_layout(cmd, color_render_target, VK_IMAGE_LAYOUT_UNDEFINED, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL);
			Texture::transition_layout(cmd, depth_render_target, VK_IMAGE_LAYOUT_UNDEFINED, VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_OPTIMAL); // TODO check if necessary for depth each frame

			// draw environment map
			{
			
				VKW_GraphicsPipeline& pipeline = environment_map_pipeline;
				pipeline.set_render_size(swapchain.get_extent());

				// would theoretically not need to clear the screen
				pipeline.set_color_attachment(
					color_render_target.get_image_view(VK_IMAGE_ASPECT_COLOR_BIT),
					true,
					{ {0.2f, 0.2f, 0.2f, 1.0f} }
				);

				pipeline.set_depth_attachment(
					depth_render_target.get_image_view(VK_IMAGE_ASPECT_DEPTH_BIT),
					true,
					1.0f
				);
			
				pipeline.begin_rendering(cmd);
				{
					pipeline.bind(cmd);

					pipeline.set_dynamic_state(cmd);
					environment_map.draw(cmd, current_frame, pipeline);
				}
				pipeline.end_rendering(cmd);
			}
		

			// draw terrain
			{
				VKW_GraphicsPipeline& pipeline = (gui_input.terrain_wireframe_mode) ? terrain_wireframe_pipelines.at(gui_input.nr_shadow_cascades - 1) : terrain_pipelines.at(gui_input.nr_shadow_cascades - 1);
				pipeline.set_render_size(swapchain.get_extent());

				pipeline.set_color_attachment(
					color_render_target.get_image_view(VK_IMAGE_ASPECT_COLOR_BIT),
					false,
					{ {1.0f, 0.0f, 1.0f, 1.0f} }
				);
			

				pipeline.set_depth_attachment(
					depth_render_target.get_image_view(VK_IMAGE_ASPECT_DEPTH_BIT),
					false,
					1.0f
				);

				pipeline.begin_rendering(cmd);
				{
					pipeline.bind(cmd);

					pipeline.set_dynamic_state(cmd);
					
					terrain.draw(cmd, current_frame, pipeline);
				}
				pipeline.end_rendering(cmd);
			}

			// draw lines
			{
				VKW_GraphicsPipeline& pipeline = line_pipeline;
				pipeline.set_render_size(swapchain.get_extent());

				pipeline.set_color_attachment(
					color_render_target.get_image_view(VK_IMAGE_ASPECT_COLOR_BIT),
					false,
					{ {1.0f, 0.0f, 1.0f, 1.0f} }
				);


				pipeline.set_depth_attachment(
					depth_render_target.get_image_view(VK_IMAGE_ASPECT_DEPTH_BIT),
					false,
					1.0f
				);

				pipeline.begin_rendering(cmd);
				{
					pipeline.bind(cmd);

					pipeline.set_dynamic_state(cmd);

					spherical_gaussian.draw(cmd, current_frame, pipeline);

					if (gui_input.shadow_draw_debug_frustums)
						directional_light.draw_debug_lines(cmd, current_frame, pipeline, gui_input.nr_shadow_cascades);
				}
				pipeline.end_rendering(cmd);
			}
		
			// transitions for copy into swapchain images
			Texture::transition_layout(cmd, color_render_target, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL, VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL);
			Texture::transition_layout(cmd, swapchain.images_at(current_swapchain_image_idx), VK_IMAGE_LAYOUT_UNDEFINED, VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL);

			// copy (both have swapchain extent resolution
			Texture::copy(cmd, color_render_target, swapchain.images_at(current_swapchain_image_idx), swapchain.get_extent(), swapchain.get_extent());

		
			// transition for imgui
			Texture::transition_layout(cmd, swapchain.images_at(current_swapchain_image_idx), VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL);

			// draw imgui
			gui.draw(cmd, current_swapchain_image_idx);


			// transition for present
			Texture::transition_layout(cmd, swapchain.images_at(current_swapchain_image_idx), VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL, VK_IMAGE_LAYOUT_PRESENT_SRC_KHR);
		}
	
		// end and submit command buffer

		cmd.submit(
			{ get_current_swapchain_semaphore(), directional_light.get_shadow_pass_semaphore(current_frame) },
			{ VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT, VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT },
			{ get_current_render_semaphore() },
			get_current_render_fence()
		);
	}
	
}

void Engine::present()
{
	if (!swapchain.present({ get_current_render_semaphore() }, current_swapchain_image_idx)) {
		std::cout << "Recreate swapchain (Present)" << std::endl;
		resize_window = true;
	}
}

void Engine::late_update()
{
	current_frame = (current_frame + 1) % MAX_FRAMES_IN_FLIGHT;

}

inline void Engine::resize()
{
}

// TODO: Query glfwGetRequiredInstanceExtensions() and add it to list of required extensions
void Engine::init_glfw()
{
	if (!glfwInit()) {
		throw SetupException("GLFW Initilization failed", __FILE__, __LINE__);
	}

	glfwWindowHint(GLFW_CLIENT_API, GLFW_NO_API);

	window = glfwCreateWindow(res_x, res_y, "Wulkan", nullptr, nullptr);

	if (!window) {
		glfwTerminate();
		throw SetupException("GLFW Window creation failed", __FILE__, __LINE__);
	}

	glfwSetWindowUserPointer(window, this);
	
	// disable cursor so can use raw mouse movement
	if (!glfwRawMouseMotionSupported()) {
		throw std::runtime_error("Raw mouse motion not supported");
	}

	glfwSetInputMode(window, GLFW_CURSOR, GLFW_CURSOR_DISABLED);
	glfwSetCursorPosCallback(window, glfm_mouse_move_callback);
}

void Engine::init_vulkan()
{
	VK_CHECK_ET(volkInitialize(), RuntimeException, "Failed to initialize volk");

	init_instance();
	create_surface();
	create_device();
	create_queues();

	create_swapchain();
	
	create_command_structs();
	create_sync_structs();

	create_texture_samplers();

	create_uniform_buffers();

	init_shared_data();
	create_descriptor_sets();

	init_data();


	create_graphics_pipelines();
}

void Engine::init_instance()
{
	instance.init("Wulkan", get_required_instance_extensions(), std::vector<const char*>());
	cleanup_queue.add(&instance);
}

void Engine::create_surface()
{
	surface.init(window, &instance);
	cleanup_queue.add(&surface);
}

void Engine::create_device()
{
	Required_Device_Features required_features = get_required_device_features();

	device.init(&instance, surface, get_required_device_extensions(), required_features, "Device");
	cleanup_queue.add(&device);

	VkPhysicalDeviceProperties deviceProperties;
	vkGetPhysicalDeviceProperties(device.get_physical_device(), &deviceProperties);
	std::cout << "Selected GPU:" << deviceProperties.deviceName << std::endl;
	std::cout << "Tesselation limit:" << deviceProperties.limits.maxTessellationGenerationLevel << std::endl;
}

void Engine::create_queues()
{
	graphics_queue.init(device, vkb::QueueType::graphics, "Graphics queue");
	present_queue.init(device, vkb::QueueType::present, "Present queue");
	transfer_queue.init(device, vkb::QueueType::transfer, "Transfer queue");
	std::cout << "Chosen queues:" << graphics_queue.get_queue_family() << "," << present_queue.get_queue_family() << "," << transfer_queue.get_queue_family() << std::endl;
}

void Engine::init_shared_data()
{
	shared_terrain_data.init(&device);
	cleanup_queue.add(&shared_terrain_data);

	shared_environment_data.init(&device);
	cleanup_queue.add(&shared_environment_data);

	shared_line_data.init(&device);
	cleanup_queue.add(&shared_line_data);
}

void Engine::init_data()
{
	std::array<VKW_CommandPool, MAX_FRAMES_IN_FLIGHT> graphic_pools;
	for (unsigned int i = 0; i < MAX_FRAMES_IN_FLIGHT; i++) {
		graphic_pools.at(i) = command_structs.at(i).graphics_command_pool;
	}
	directional_light.init(
		&device,
		graphic_pools,
		
		glm::vec3(0, 0, 0), // look at for shadow
		glm::vec3(0, 0, 1), // direction for shadow
		50, // distance from look at for projection
		1024*2,
		1024*2,
		40, // height of orthographic projection
		0.1,
		50.0
	);
	directional_light.set_color(glm::vec3(0.8, 0.8, 1.0));
	directional_light.set_intensity(1.0f);
	directional_light.init_debug_lines(
		get_current_transfer_pool(),
		descriptor_pool,
		&shared_line_data,
		uniform_buffers
	);
	cleanup_queue.add(&directional_light);


	spherical_gaussian.init(
		device,
		get_current_transfer_pool(),
		descriptor_pool,
		&shared_line_data,
		{
			glm::vec3(0.053243,-0.163862,-0.914796),
glm::vec3(0.085689,-0.263719,-0.888288),
glm::vec3(0.016182,-0.251425,-0.895671),
glm::vec3(0.104738,-0.322345,-0.863299),
glm::vec3(0.134695,-0.212918,-0.895671),
glm::vec3(0.200159,-0.276346,-0.862085),
glm::vec3(0.000503,-0.341218,-0.862085),
glm::vec3(0.105823,-0.076884,-0.921135),
glm::vec3(-0.040420,-0.124401,-0.92113),
glm::vec3(0.000000,0.000000,-0.930305),
glm::vec3(-0.073931,-0.227539,-0.89843),
glm::vec3(0.247027,-0.355432,-0.815495),
glm::vec3(0.280647,-0.203900,-0.859530),
glm::vec3(0.393367,-0.285795,-0.786741),
glm::vec3(0.129583,-0.398807,-0.822418),
glm::vec3(0.193558,-0.140627,-0.898431),
glm::vec3(-0.107196,-0.329918,-0.85953),
glm::vec3(0.009073,-0.432749,-0.815495),
glm::vec3(-0.150250,-0.462429,-0.78674),
glm::vec3(0.671045,-0.362358,-0.533788),
glm::vec3(0.657405,-0.276164,-0.597910),
glm::vec3(0.703876,-0.271721,-0.544452),
glm::vec3(0.642577,-0.220605,-0.631340),
glm::vec3(0.618118,-0.334027,-0.609965),
glm::vec3(0.568709,-0.282263,-0.675661),
glm::vec3(0.713182,-0.177299,-0.565293),
glm::vec3(0.619213,-0.449880,-0.528944),
glm::vec3(0.725036,-0.372995,-0.448102),
glm::vec3(0.673174,-0.489085,-0.416049),
glm::vec3(0.757104,-0.268809,-0.467921),
glm::vec3(0.525873,-0.206107,-0.730317),
glm::vec3(0.496449,-0.360688,-0.694674),
glm::vec3(0.617237,-0.143784,-0.671233),
glm::vec3(0.563546,-0.409436,-0.615787),
glm::vec3(0.777097,-0.156788,-0.480278),
glm::vec3(0.698060,-0.081008,-0.598779),
glm::vec3(0.786735,0.000000,-0.486234),
glm::vec3(-0.139390,-0.101273,-0.91479),
glm::vec3(-0.224334,-0.162988,-0.88828),
glm::vec3(-0.234121,-0.093084,-0.89567),
glm::vec3(-0.274204,-0.199221,-0.86329),
glm::vec3(-0.160875,-0.193897,-0.89567),
glm::vec3(-0.200969,-0.275757,-0.86208),
glm::vec3(-0.324365,-0.105920,-0.86208),
glm::vec3(-0.130804,0.000000,-0.921135),
glm::vec3(-0.239250,-0.000000,-0.89843),
glm::vec3(-0.261702,-0.344770,-0.81549),
glm::vec3(-0.339247,-0.246477,-0.82241),
glm::vec3(-0.346898,0.000000,-0.859529),
glm::vec3(-0.408767,-0.142354,-0.81549),
glm::vec3(-0.486229,-0.000000,-0.78673),
glm::vec3(-0.139390,0.101273,-0.914796),
glm::vec3(-0.224334,0.162988,-0.888287),
glm::vec3(-0.160875,0.193897,-0.895671),
glm::vec3(-0.274204,0.199221,-0.863299),
glm::vec3(-0.234121,0.093084,-0.895670),
glm::vec3(-0.324365,0.105920,-0.862084),
glm::vec3(-0.200969,0.275757,-0.862085),
glm::vec3(-0.040420,0.124402,-0.921135),
glm::vec3(-0.073931,0.227539,-0.898431),
glm::vec3(-0.408767,0.142354,-0.815494),
glm::vec3(-0.339247,0.246477,-0.822416),
glm::vec3(-0.107196,0.329918,-0.859530),
glm::vec3(-0.261702,0.344770,-0.815495),
glm::vec3(-0.150250,0.462429,-0.786741),
glm::vec3(0.053243,0.163862,-0.914796),
glm::vec3(0.085689,0.263719,-0.888288),
glm::vec3(0.134695,0.212918,-0.895671),
glm::vec3(0.104738,0.322345,-0.863299),
glm::vec3(0.016182,0.251425,-0.895671),
glm::vec3(0.000503,0.341218,-0.862085),
glm::vec3(0.200159,0.276346,-0.862085),
glm::vec3(0.105823,0.076884,-0.921135),
glm::vec3(0.193558,0.140626,-0.898431),
glm::vec3(0.009073,0.432749,-0.815495),
glm::vec3(0.129583,0.398807,-0.822418),
glm::vec3(0.280647,0.203900,-0.859530),
glm::vec3(0.247027,0.355432,-0.815495),
glm::vec3(0.393367,0.285795,-0.786741),
glm::vec3(0.777531,-0.362359,-0.361491),
glm::vec3(0.828783,-0.276165,-0.320615),
glm::vec3(0.821997,-0.334028,-0.280083),
glm::vec3(0.852053,-0.220605,-0.292401),
glm::vec3(0.801752,-0.271722,-0.386087),
glm::vec3(0.824554,-0.177299,-0.385090),
glm::vec3(0.858661,-0.282264,-0.206509),
glm::vec3(0.750018,-0.449880,-0.317296),
glm::vec3(0.802799,-0.409437,-0.228668),
glm::vec3(0.847742,-0.081008,-0.356589),
glm::vec3(0.876403,-0.143784,-0.251896),
glm::vec3(0.843351,-0.360689,-0.133375),
glm::vec3(0.888391,-0.206108,-0.143753),
glm::vec3(0.879599,-0.285796,-0.000000),
glm::vec3(-0.104354,-0.851451,-0.36149),
glm::vec3(-0.006541,-0.873558,-0.32061),
glm::vec3(-0.063669,-0.884985,-0.28008),
glm::vec3(0.053491,-0.878520,-0.292402),
glm::vec3(-0.010667,-0.846477,-0.38608),
glm::vec3(0.086181,-0.838985,-0.385091),
glm::vec3(-0.003109,-0.903859,-0.20651),
glm::vec3(-0.130691,-0.804811,-0.44810),
glm::vec3(-0.196094,-0.852330,-0.31729),
glm::vec3(-0.257126,-0.791362,-0.41604),
glm::vec3(-0.141321,-0.890030,-0.22866),
glm::vec3(0.184925,-0.831281,-0.356590),
glm::vec3(0.091024,-0.787511,-0.480278),
glm::vec3(0.243117,-0.748227,-0.486235),
glm::vec3(0.134077,-0.877939,-0.251896),
glm::vec3(-0.021694,-0.803114,-0.46792),
glm::vec3(-0.082428,-0.913533,-0.13337),
glm::vec3(0.078506,-0.908600,-0.143753),
glm::vec3(0.000000,-0.924864,-0.000000),
glm::vec3(-0.842027,-0.163863,-0.36148),
glm::vec3(-0.832827,-0.263720,-0.32061),
glm::vec3(-0.861348,-0.212919,-0.28008),
glm::vec3(-0.818996,-0.322346,-0.29240),
glm::vec3(-0.808346,-0.251426,-0.38608),
glm::vec3(-0.771293,-0.341220,-0.38508),
glm::vec3(-0.860584,-0.276347,-0.20650),
glm::vec3(-0.805809,-0.124402,-0.44810),
glm::vec3(-0.871212,-0.076884,-0.31729),
glm::vec3(-0.832088,0.000000,-0.416047),
glm::vec3(-0.890141,-0.140627,-0.22866),
glm::vec3(-0.733454,-0.432750,-0.35658),
glm::vec3(-0.720843,-0.329919,-0.48027),
glm::vec3(-0.636482,-0.462430,-0.48623),
glm::vec3(-0.793540,-0.398809,-0.25189),
glm::vec3(-0.770514,-0.227540,-0.46792),
glm::vec3(-0.894295,-0.203901,-0.13337),
glm::vec3(-0.839872,-0.355433,-0.14375),
glm::vec3(-0.879599,-0.285796,0.000000),
glm::vec3(-0.416042,0.750177,-0.361491),
glm::vec3(-0.508170,0.710570,-0.320615),
glm::vec3(-0.468669,0.753393,-0.280084),
glm::vec3(-0.559654,0.679298,-0.292401),
glm::vec3(-0.488913,0.691086,-0.386087),
glm::vec3(-0.562862,0.628099,-0.385090),
glm::vec3(-0.528758,0.733066,-0.206509),
glm::vec3(-0.367320,0.727926,-0.448102),
glm::vec3(-0.342339,0.804812,-0.317296),
glm::vec3(-0.257126,0.791362,-0.416049),
glm::vec3(-0.408812,0.803117,-0.228668),
glm::vec3(-0.638221,0.563827,-0.356589),
glm::vec3(-0.536525,0.583610,-0.480278),
glm::vec3(-0.636482,0.462430,-0.486234),
glm::vec3(-0.624509,0.631460,-0.251896),
glm::vec3(-0.454504,0.662487,-0.467922),
glm::vec3(-0.470274,0.787514,-0.133375),
glm::vec3(-0.597574,0.688928,-0.143753),
glm::vec3(-0.543622,0.748230,0.000000),
glm::vec3(0.584899,0.627496,-0.361491),
glm::vec3(0.518761,0.702876,-0.320615),
glm::vec3(0.571695,0.678541,-0.280084),
glm::vec3(0.473111,0.742176,-0.292401),
glm::vec3(0.506182,0.678540,-0.386087),
glm::vec3(0.423427,0.729406,-0.385091),
glm::vec3(0.533794,0.729407,-0.206510),
glm::vec3(0.578793,0.574283,-0.448102),
glm::vec3(0.659635,0.574283,-0.317296),
glm::vec3(0.673174,0.489085,-0.416049),
glm::vec3(0.637480,0.636979,-0.228668),
glm::vec3(0.339013,0.781215,-0.356590),
glm::vec3(0.389254,0.690609,-0.480278),
glm::vec3(0.243117,0.748227,-0.486235),
glm::vec3(0.407573,0.789074,-0.251896),
glm::vec3(0.489615,0.636978,-0.467922),
glm::vec3(0.603649,0.690611,-0.133375),
glm::vec3(0.470551,0.781216,-0.143753),
glm::vec3(0.543622,0.748230,-0.000000),
glm::vec3(0.724289,-0.526223,-0.255004),
glm::vec3(0.743096,-0.539887,-0.149236),
glm::vec3(0.699814,-0.585456,-0.182208),
glm::vec3(0.747317,-0.542954,-0.082924),
glm::vec3(0.773060,-0.484642,-0.182208),
glm::vec3(0.802976,-0.453647,-0.095137),
glm::vec3(0.679581,-0.623486,-0.095137),
glm::vec3(0.659635,-0.574283,-0.317296),
glm::vec3(0.637480,-0.636979,-0.228668),
glm::vec3(0.813551,-0.436443,0.005930),
glm::vec3(0.746822,-0.542595,0.007270),
glm::vec3(0.603649,-0.690611,-0.133375),
glm::vec3(0.666486,-0.638861,0.005930),
glm::vec3(0.543622,-0.748230,-0.000000),
glm::vec3(-0.276651,-0.851451,-0.25500),
glm::vec3(-0.283836,-0.873560,-0.14923),
glm::vec3(-0.340549,-0.846478,-0.18220),
glm::vec3(-0.285448,-0.878522,-0.08292),
glm::vec3(-0.222035,-0.884986,-0.18220),
glm::vec3(-0.183313,-0.903860,-0.09513),
glm::vec3(-0.382971,-0.838987,-0.09513),
glm::vec3(-0.342339,-0.804812,-0.31729),
glm::vec3(-0.408812,-0.803117,-0.22866),
glm::vec3(-0.163684,-0.908600,0.005930),
glm::vec3(-0.285260,-0.877940,0.007270),
glm::vec3(-0.470274,-0.787514,-0.13337),
glm::vec3(-0.401640,-0.831284,0.005930),
glm::vec3(-0.543622,-0.748230,0.000000),
glm::vec3(-0.895270,0.000000,-0.255003),
glm::vec3(-0.918517,-0.000000,-0.14923),
glm::vec3(-0.910286,0.062306,-0.182206),
glm::vec3(-0.923734,-0.000000,-0.08292),
glm::vec3(-0.910286,-0.062306,-0.18220),
glm::vec3(-0.916270,-0.104965,-0.09513),
glm::vec3(-0.916270,0.104965,-0.095136),
glm::vec3(-0.871212,0.076884,-0.317294),
glm::vec3(-0.890141,0.140627,-0.228667),
glm::vec3(-0.914713,-0.125099,0.005930),
glm::vec3(-0.923122,-0.000000,0.007270),
glm::vec3(-0.894295,0.203901,-0.133374),
glm::vec3(-0.914713,0.125099,0.005930),
glm::vec3(-0.879599,0.285796,0.000000),
glm::vec3(-0.276651,0.851451,-0.255004),
glm::vec3(-0.283836,0.873560,-0.149236),
glm::vec3(-0.222035,0.884986,-0.182208),
glm::vec3(-0.285448,0.878522,-0.082924),
glm::vec3(-0.340549,0.846478,-0.182208),
glm::vec3(-0.382971,0.838987,-0.095137),
glm::vec3(-0.183313,0.903859,-0.095137),
glm::vec3(-0.196094,0.852330,-0.317296),
glm::vec3(-0.141321,0.890030,-0.228668),
glm::vec3(-0.401640,0.831284,0.005930),
glm::vec3(-0.285260,0.877940,0.007270),
glm::vec3(-0.082428,0.913533,-0.133375),
glm::vec3(-0.163684,0.908600,0.005930),
glm::vec3(-0.000000,0.924864,0.000000),
glm::vec3(0.724289,0.526223,-0.255004),
glm::vec3(0.743096,0.539887,-0.149236),
glm::vec3(0.773060,0.484642,-0.182208),
glm::vec3(0.747317,0.542954,-0.082924),
glm::vec3(0.699814,0.585456,-0.182208),
glm::vec3(0.679581,0.623486,-0.095137),
glm::vec3(0.802976,0.453647,-0.095137),
glm::vec3(0.750018,0.449880,-0.317296),
glm::vec3(0.802799,0.409437,-0.228668),
glm::vec3(0.666486,0.638861,0.005930),
glm::vec3(0.746822,0.542595,0.007270),
glm::vec3(0.843351,0.360689,-0.133375),
glm::vec3(0.813551,0.436443,0.005930),
glm::vec3(0.879599,0.285796,-0.000000),
glm::vec3(0.329893,-0.687586,0.533789),
glm::vec3(0.369522,-0.609836,0.597910),
glm::vec3(0.303727,-0.633556,0.609966),
glm::vec3(0.390184,-0.556171,0.631340),
glm::vec3(0.409730,-0.633556,0.544452),
glm::vec3(0.472760,-0.562636,0.565293),
glm::vec3(0.294180,-0.562635,0.675661),
glm::vec3(0.367320,-0.727926,0.448102),
glm::vec3(0.236514,-0.727926,0.528944),
glm::vec3(0.257126,-0.791362,0.416049),
glm::vec3(0.215252,-0.662486,0.615787),
glm::vec3(0.517125,-0.475846,0.598779),
glm::vec3(0.536525,-0.583610,0.480278),
glm::vec3(0.636482,-0.462430,0.486234),
glm::vec3(0.414839,-0.479126,0.671233),
glm::vec3(0.454504,-0.662487,0.467922),
glm::vec3(0.189623,-0.583609,0.694674),
glm::vec3(0.304290,-0.475845,0.730317),
glm::vec3(0.150250,-0.462429,0.786741),
glm::vec3(-0.551992,-0.526222,0.533789),
glm::vec3(-0.465802,-0.539885,0.597910),
glm::vec3(-0.508692,-0.484640,0.609966),
glm::vec3(-0.408379,-0.542952,0.631341),
glm::vec3(-0.475936,-0.585455,0.544453),
glm::vec3(-0.389010,-0.623484,0.565294),
glm::vec3(-0.444193,-0.453645,0.675662),
glm::vec3(-0.578793,-0.574283,0.448102),
glm::vec3(-0.619213,-0.449880,0.528944),
glm::vec3(-0.673174,-0.489085,0.416049),
glm::vec3(-0.563546,-0.409436,0.615787),
glm::vec3(-0.292759,-0.638858,0.598780),
glm::vec3(-0.389254,-0.690609,0.480278),
glm::vec3(-0.243117,-0.748227,0.486235),
glm::vec3(-0.327487,-0.542592,0.671233),
glm::vec3(-0.489615,-0.636978,0.467922),
glm::vec3(-0.496449,-0.360688,0.694674),
glm::vec3(-0.358527,-0.436441,0.730318),
glm::vec3(-0.393367,-0.285795,0.786741),
glm::vec3(-0.671045,0.362358,0.533788),
glm::vec3(-0.657405,0.276164,0.597910),
glm::vec3(-0.618118,0.334027,0.609965),
glm::vec3(-0.642577,0.220605,0.631340),
glm::vec3(-0.703876,0.271721,0.544452),
glm::vec3(-0.713182,0.177299,0.565293),
glm::vec3(-0.568709,0.282263,0.675661),
glm::vec3(-0.725036,0.372995,0.448102),
glm::vec3(-0.619213,0.449880,0.528944),
glm::vec3(-0.673174,0.489085,0.416049),
glm::vec3(-0.563546,0.409436,0.615787),
glm::vec3(-0.698060,0.081008,0.598779),
glm::vec3(-0.777097,0.156788,0.480277),
glm::vec3(-0.786735,0.000000,0.486234),
glm::vec3(-0.617237,0.143784,0.671233),
glm::vec3(-0.757104,0.268809,0.467921),
glm::vec3(-0.496449,0.360688,0.694674),
glm::vec3(-0.525873,0.206107,0.730317),
glm::vec3(-0.393367,0.285795,0.786741),
glm::vec3(0.137258,0.750176,0.533789),
glm::vec3(0.059498,0.710568,0.597910),
glm::vec3(0.126669,0.691085,0.609966),
glm::vec3(0.011239,0.679296,0.631341),
glm::vec3(0.040912,0.753391,0.544453),
glm::vec3(-0.051766,0.733063,0.565294),
glm::vec3(0.092707,0.628097,0.675662),
glm::vec3(0.130691,0.804811,0.448102),
glm::vec3(0.236514,0.727926,0.528944),
glm::vec3(0.257126,0.791362,0.416049),
glm::vec3(0.215252,0.662486,0.615787),
glm::vec3(-0.138671,0.688925,0.598780),
glm::vec3(-0.091024,0.787511,0.480278),
glm::vec3(-0.243117,0.748227,0.486235),
glm::vec3(-0.053992,0.631458,0.671234),
glm::vec3(0.021694,0.803114,0.467922),
glm::vec3(0.189623,0.583609,0.694674),
glm::vec3(0.033515,0.563824,0.730318),
glm::vec3(0.150250,0.462429,0.786741),
glm::vec3(0.755878,0.101273,0.533786),
glm::vec3(0.694179,0.162988,0.597908),
glm::vec3(0.696407,0.093084,0.609963),
glm::vec3(0.649526,0.199221,0.631338),
glm::vec3(0.729163,0.193898,0.544450),
glm::vec3(0.681191,0.275758,0.565292),
glm::vec3(0.626007,0.105920,0.675659),
glm::vec3(0.805809,0.124402,0.448100),
glm::vec3(0.765388,-0.000000,0.528941),
glm::vec3(0.832088,0.000000,0.416047),
glm::vec3(0.696581,0.000000,0.615785),
glm::vec3(0.612358,0.344770,0.598778),
glm::vec3(0.720843,0.329919,0.480277),
glm::vec3(0.636482,0.462430,0.486234),
glm::vec3(0.583871,0.246477,0.671232),
glm::vec3(0.770514,0.227540,0.467920),
glm::vec3(0.613645,0.000000,0.694671),
glm::vec3(0.546589,0.142354,0.730316),
glm::vec3(0.486229,0.000000,0.786739),
glm::vec3(0.274204,0.199221,0.863299),
glm::vec3(0.234121,0.093084,0.895670),
glm::vec3(0.324365,0.105920,0.862084),
glm::vec3(0.160875,0.193897,0.895671),
glm::vec3(0.200969,0.275757,0.862085),
glm::vec3(0.139390,0.101273,0.914796),
glm::vec3(0.224334,0.162988,0.888287),
glm::vec3(0.408767,0.142354,0.815494),
glm::vec3(0.346898,-0.000000,0.859529),
glm::vec3(0.339247,0.246477,0.822416),
glm::vec3(0.239250,-0.000000,0.898430),
glm::vec3(0.107196,0.329918,0.859530),
glm::vec3(0.261702,0.344770,0.815495),
glm::vec3(0.073931,0.227539,0.898430),
glm::vec3(0.130804,-0.000000,0.921135),
glm::vec3(0.040420,0.124402,0.921135),
glm::vec3(-0.000000,-0.000000,0.930305),
glm::vec3(0.471686,0.212199,0.763210),
glm::vec3(0.453115,0.329207,0.733163),
glm::vec3(0.404624,0.293976,0.774725),
glm::vec3(0.527191,0.383026,0.652200),
glm::vec3(0.511976,0.293976,0.708379),
glm::vec3(0.347571,0.383025,0.763210),
glm::vec3(0.437798,0.396073,0.708379),
glm::vec3(0.517125,0.475846,0.598779),
glm::vec3(0.414839,0.479126,0.671233),
glm::vec3(0.304290,0.475845,0.730317),
glm::vec3(0.409730,0.633556,0.544452),
glm::vec3(0.390184,0.556171,0.631340),
glm::vec3(0.472760,0.562636,0.565293),
glm::vec3(0.329893,0.687586,0.533789),
glm::vec3(0.369522,0.609836,0.597910),
glm::vec3(0.303727,0.633556,0.609966),
glm::vec3(0.294180,0.562635,0.675661),
glm::vec3(0.536525,0.583610,0.480278),
glm::vec3(0.454504,0.662487,0.467922),
glm::vec3(0.367320,0.727926,0.448102),
glm::vec3(-0.104738,0.322345,0.863299),
glm::vec3(-0.016182,0.251425,0.895671),
glm::vec3(-0.000503,0.341218,0.862085),
glm::vec3(-0.134695,0.212918,0.895671),
glm::vec3(-0.200159,0.276346,0.862085),
glm::vec3(-0.053243,0.163862,0.914796),
glm::vec3(-0.085689,0.263719,0.888288),
glm::vec3(-0.009073,0.432749,0.815495),
glm::vec3(-0.129583,0.398807,0.822417),
glm::vec3(-0.280647,0.203900,0.859530),
glm::vec3(-0.247027,0.355432,0.815495),
glm::vec3(-0.193558,0.140627,0.898431),
glm::vec3(-0.105823,0.076884,0.921135),
glm::vec3(-0.056057,0.514171,0.763211),
glm::vec3(-0.173077,0.532667,0.733164),
glm::vec3(-0.154555,0.475662,0.774727),
glm::vec3(-0.201372,0.619748,0.652201),
glm::vec3(-0.121382,0.577760,0.708380),
glm::vec3(-0.256876,0.448920,0.763211),
glm::vec3(-0.241404,0.538762,0.708380),
glm::vec3(-0.292759,0.638858,0.598780),
glm::vec3(-0.327487,0.542592,0.671233),
glm::vec3(-0.358527,0.436441,0.730318),
glm::vec3(-0.475937,0.585455,0.544453),
glm::vec3(-0.408379,0.542952,0.631341),
glm::vec3(-0.389010,0.623484,0.565294),
glm::vec3(-0.551992,0.526222,0.533789),
glm::vec3(-0.465802,0.539885,0.597910),
glm::vec3(-0.508692,0.484640,0.609966),
glm::vec3(-0.444193,0.453645,0.675662),
glm::vec3(-0.389254,0.690609,0.480278),
glm::vec3(-0.489615,0.636978,0.467922),
glm::vec3(-0.578793,0.574283,0.448102),
glm::vec3(-0.338936,0.000000,0.863299),
glm::vec3(-0.244121,0.062306,0.895671),
glm::vec3(-0.324675,0.104965,0.862085),
glm::vec3(-0.244121,-0.062306,0.895671),
glm::vec3(-0.324675,-0.104965,0.862085),
glm::vec3(-0.172296,-0.000000,0.914796),
glm::vec3(-0.277292,-0.000000,0.888288),
glm::vec3(-0.414373,0.125099,0.815495),
glm::vec3(-0.419333,0.000000,0.822417),
glm::vec3(-0.280647,-0.203900,0.859530),
glm::vec3(-0.414373,-0.125099,0.815495),
glm::vec3(-0.193558,-0.140626,0.898431),
glm::vec3(-0.105823,-0.076884,0.921135),
glm::vec3(-0.506329,0.105576,0.763211),
glm::vec3(-0.560082,-0.000000,0.733164),
glm::vec3(-0.500144,-0.000000,0.774726),
glm::vec3(-0.651644,0.000000,0.652200),
glm::vec3(-0.586993,0.063099,0.708379),
glm::vec3(-0.506329,-0.105576,0.763211),
glm::vec3(-0.586993,-0.063099,0.708380),
glm::vec3(-0.698060,-0.081008,0.598779),
glm::vec3(-0.617237,-0.143784,0.671233),
glm::vec3(-0.525873,-0.206107,0.730317),
glm::vec3(-0.703876,-0.271721,0.544452),
glm::vec3(-0.642577,-0.220605,0.631340),
glm::vec3(-0.713182,-0.177299,0.565293),
glm::vec3(-0.671045,-0.362358,0.533788),
glm::vec3(-0.657405,-0.276164,0.597910),
glm::vec3(-0.618118,-0.334027,0.609965),
glm::vec3(-0.568709,-0.282263,0.675661),
glm::vec3(-0.777097,-0.156788,0.480278),
glm::vec3(-0.757104,-0.268809,0.467921),
glm::vec3(-0.725036,-0.372995,0.448102),
glm::vec3(-0.104738,-0.322345,0.863299),
glm::vec3(-0.134695,-0.212918,0.895671),
glm::vec3(-0.200159,-0.276346,0.862085),
glm::vec3(-0.016182,-0.251425,0.895671),
glm::vec3(-0.000503,-0.341218,0.862085),
glm::vec3(-0.053243,-0.163862,0.914796),
glm::vec3(-0.085689,-0.263719,0.888288),
glm::vec3(-0.247027,-0.355432,0.815495),
glm::vec3(-0.129583,-0.398807,0.822417),
glm::vec3(0.107196,-0.329918,0.859530),
glm::vec3(-0.009073,-0.432749,0.815495),
glm::vec3(0.073931,-0.227539,0.898430),
glm::vec3(0.040420,-0.124401,0.921135),
glm::vec3(-0.256876,-0.448920,0.763211),
glm::vec3(-0.173077,-0.532667,0.733164),
glm::vec3(-0.154555,-0.475662,0.774727),
glm::vec3(-0.201372,-0.619748,0.652201),
glm::vec3(-0.241404,-0.538762,0.708380),
glm::vec3(-0.056057,-0.514171,0.763211),
glm::vec3(-0.121382,-0.577760,0.708380),
glm::vec3(-0.138671,-0.688925,0.598780),
glm::vec3(-0.053992,-0.631458,0.671234),
glm::vec3(0.033515,-0.563824,0.730318),
glm::vec3(0.040912,-0.753391,0.544453),
glm::vec3(0.011239,-0.679296,0.631341),
glm::vec3(-0.051766,-0.733063,0.565294),
glm::vec3(0.137258,-0.750176,0.533789),
glm::vec3(0.059498,-0.710568,0.597910),
glm::vec3(0.126669,-0.691085,0.609966),
glm::vec3(0.092707,-0.628097,0.675662),
glm::vec3(-0.091024,-0.787511,0.480278),
glm::vec3(0.021694,-0.803114,0.467922),
glm::vec3(0.130691,-0.804811,0.448102),
glm::vec3(0.274204,-0.199221,0.863299),
glm::vec3(0.160875,-0.193897,0.895671),
glm::vec3(0.200969,-0.275757,0.862085),
glm::vec3(0.234121,-0.093084,0.895670),
glm::vec3(0.324365,-0.105920,0.862084),
glm::vec3(0.139390,-0.101273,0.914796),
glm::vec3(0.224334,-0.162988,0.888287),
glm::vec3(0.261702,-0.344770,0.815495),
glm::vec3(0.339247,-0.246477,0.822416),
glm::vec3(0.408767,-0.142354,0.815494),
glm::vec3(0.347571,-0.383025,0.763210),
glm::vec3(0.453115,-0.329207,0.733163),
glm::vec3(0.404624,-0.293976,0.774725),
glm::vec3(0.527191,-0.383026,0.652200),
glm::vec3(0.437798,-0.396073,0.708379),
glm::vec3(0.471686,-0.212199,0.763210),
glm::vec3(0.511976,-0.293976,0.708379),
glm::vec3(0.612359,-0.344770,0.598778),
glm::vec3(0.583871,-0.246477,0.671232),
glm::vec3(0.546589,-0.142354,0.730316),
glm::vec3(0.729163,-0.193898,0.544450),
glm::vec3(0.649526,-0.199221,0.631338),
glm::vec3(0.681191,-0.275758,0.565292),
glm::vec3(0.755878,-0.101273,0.533786),
glm::vec3(0.694179,-0.162988,0.597908),
glm::vec3(0.696407,-0.093084,0.609963),
glm::vec3(0.626007,-0.105920,0.675659),
glm::vec3(0.720843,-0.329919,0.480277),
glm::vec3(0.770514,-0.227540,0.467920),
glm::vec3(0.805809,-0.124402,0.448100),
glm::vec3(0.818996,0.322346,0.292400),
glm::vec3(0.861348,0.212919,0.280082),
glm::vec3(0.860584,0.276347,0.206508),
glm::vec3(0.808346,0.251426,0.386086),
glm::vec3(0.771293,0.341220,0.385089),
glm::vec3(0.842027,0.163863,0.361489),
glm::vec3(0.832827,0.263720,0.320613),
glm::vec3(0.839872,0.355433,0.143752),
glm::vec3(0.894295,0.203901,0.133374),
glm::vec3(0.793540,0.398809,0.251895),
glm::vec3(0.890141,0.140627,0.228667),
glm::vec3(0.733454,0.432750,0.356589),
glm::vec3(0.871212,0.076884,0.317294),
glm::vec3(0.797512,0.448922,0.111561),
glm::vec3(0.733160,0.532669,0.173077),
glm::vec3(0.762051,0.475664,0.208231),
glm::vec3(0.673397,0.619751,0.111561),
glm::vec3(0.741549,0.538764,0.100879),
glm::vec3(0.707701,0.514173,0.291182),
glm::vec3(0.687873,0.577762,0.208232),
glm::vec3(0.597574,0.688928,0.143753),
glm::vec3(0.624509,0.631460,0.251896),
glm::vec3(0.638221,0.563827,0.356589),
glm::vec3(0.468669,0.753393,0.280084),
glm::vec3(0.559654,0.679298,0.292401),
glm::vec3(0.528758,0.733066,0.206509),
glm::vec3(0.416042,0.750177,0.361491),
glm::vec3(0.508170,0.710570,0.320615),
glm::vec3(0.488913,0.691086,0.386087),
glm::vec3(0.562862,0.628099,0.385090),
glm::vec3(0.470274,0.787514,0.133375),
glm::vec3(0.408812,0.803117,0.228668),
glm::vec3(0.342339,0.804812,0.317296),
glm::vec3(-0.053491,0.878520,0.292402),
glm::vec3(0.063669,0.884985,0.280084),
glm::vec3(0.003109,0.903859,0.206510),
glm::vec3(0.010667,0.846477,0.386088),
glm::vec3(-0.086181,0.838985,0.385091),
glm::vec3(0.104354,0.851451,0.361491),
glm::vec3(0.006541,0.873558,0.320615),
glm::vec3(-0.078506,0.908600,0.143753),
glm::vec3(0.082428,0.913533,0.133375),
glm::vec3(-0.134077,0.877939,0.251896),
glm::vec3(0.141321,0.890030,0.228668),
glm::vec3(-0.184925,0.831282,0.356590),
glm::vec3(0.196094,0.852330,0.317296),
glm::vec3(-0.180509,0.897202,0.111562),
glm::vec3(-0.280043,0.861879,0.173078),
glm::vec3(-0.216901,0.871741,0.208232),
glm::vec3(-0.381330,0.831951,0.111562),
glm::vec3(-0.283247,0.871742,0.100879),
glm::vec3(-0.270320,0.831950,0.291183),
glm::vec3(-0.336924,0.832743,0.208232),
glm::vec3(-0.470551,0.781216,0.143753),
glm::vec3(-0.407573,0.789074,0.251896),
glm::vec3(-0.339013,0.781215,0.356590),
glm::vec3(-0.571695,0.678541,0.280084),
glm::vec3(-0.473111,0.742176,0.292401),
glm::vec3(-0.533794,0.729407,0.206510),
glm::vec3(-0.584899,0.627496,0.361491),
glm::vec3(-0.518761,0.702876,0.320615),
glm::vec3(-0.506182,0.678540,0.386087),
glm::vec3(-0.423427,0.729406,0.385091),
glm::vec3(-0.603649,0.690611,0.133375),
glm::vec3(-0.637480,0.636979,0.228668),
glm::vec3(-0.659635,0.574283,0.317296),
glm::vec3(-0.852053,0.220605,0.292401),
glm::vec3(-0.821997,0.334028,0.280083),
glm::vec3(-0.858661,0.282264,0.206509),
glm::vec3(-0.801752,0.271722,0.386087),
glm::vec3(-0.824554,0.177299,0.385090),
glm::vec3(-0.777531,0.362359,0.361491),
glm::vec3(-0.828783,0.276165,0.320615),
glm::vec3(-0.888391,0.206108,0.143753),
glm::vec3(-0.843351,0.360689,0.133375),
glm::vec3(-0.876403,0.143784,0.251896),
glm::vec3(-0.802799,0.409437,0.228668),
glm::vec3(-0.847742,0.081008,0.356589),
glm::vec3(-0.750018,0.449880,0.317296),
glm::vec3(-0.909072,0.105576,0.111561),
glm::vec3(-0.906235,0.000000,0.173077),
glm::vec3(-0.896102,0.063099,0.208232),
glm::vec3(-0.909072,-0.105576,0.111561),
glm::vec3(-0.916605,0.000000,0.100879),
glm::vec3(-0.874767,0.000000,0.291182),
glm::vec3(-0.896102,-0.063099,0.208232),
glm::vec3(-0.888391,-0.206108,0.143753),
glm::vec3(-0.876403,-0.143784,0.251896),
glm::vec3(-0.847742,-0.081008,0.356589),
glm::vec3(-0.821997,-0.334028,0.280083),
glm::vec3(-0.852053,-0.220605,0.292401),
glm::vec3(-0.858661,-0.282264,0.206509),
glm::vec3(-0.777531,-0.362359,0.361491),
glm::vec3(-0.828783,-0.276165,0.320615),
glm::vec3(-0.801752,-0.271722,0.386087),
glm::vec3(-0.824554,-0.177299,0.385090),
glm::vec3(-0.843351,-0.360689,0.133375),
glm::vec3(-0.802799,-0.409437,0.228668),
glm::vec3(-0.750018,-0.449880,0.317296),
glm::vec3(-0.473111,-0.742176,0.292401),
glm::vec3(-0.571695,-0.678541,0.280084),
glm::vec3(-0.533794,-0.729407,0.206510),
glm::vec3(-0.506182,-0.678540,0.386087),
glm::vec3(-0.423427,-0.729406,0.385091),
glm::vec3(-0.584899,-0.627496,0.361491),
glm::vec3(-0.518761,-0.702876,0.320615),
glm::vec3(-0.470551,-0.781216,0.143753),
glm::vec3(-0.603649,-0.690611,0.133375),
glm::vec3(-0.407573,-0.789074,0.251896),
glm::vec3(-0.637480,-0.636979,0.228668),
glm::vec3(-0.339013,-0.781215,0.356590),
glm::vec3(-0.659635,-0.574283,0.317296),
glm::vec3(-0.381330,-0.831951,0.111562),
glm::vec3(-0.280043,-0.861879,0.173078),
glm::vec3(-0.336924,-0.832743,0.208232),
glm::vec3(-0.180509,-0.897202,0.111562),
glm::vec3(-0.283247,-0.871742,0.100879),
glm::vec3(-0.270320,-0.831950,0.291183),
glm::vec3(-0.216901,-0.871741,0.208232),
glm::vec3(-0.078506,-0.908600,0.143753),
glm::vec3(-0.134077,-0.877939,0.251896),
glm::vec3(-0.184925,-0.831282,0.356590),
glm::vec3(0.063669,-0.884985,0.280084),
glm::vec3(-0.053491,-0.878520,0.292402),
glm::vec3(0.003109,-0.903859,0.206510),
glm::vec3(0.104354,-0.851451,0.361491),
glm::vec3(0.006541,-0.873558,0.320615),
glm::vec3(0.010667,-0.846477,0.386088),
glm::vec3(-0.086181,-0.838985,0.385091),
glm::vec3(0.082428,-0.913533,0.133375),
glm::vec3(0.141321,-0.890030,0.228668),
glm::vec3(0.196094,-0.852330,0.317296),
glm::vec3(0.559654,-0.679298,0.292401),
glm::vec3(0.468669,-0.753393,0.280084),
glm::vec3(0.528758,-0.733066,0.206509),
glm::vec3(0.488913,-0.691086,0.386087),
glm::vec3(0.562862,-0.628099,0.385090),
glm::vec3(0.416042,-0.750177,0.361491),
glm::vec3(0.508170,-0.710570,0.320615),
glm::vec3(0.597574,-0.688928,0.143753),
glm::vec3(0.470274,-0.787514,0.133375),
glm::vec3(0.624509,-0.631460,0.251896),
glm::vec3(0.408812,-0.803116,0.228668),
glm::vec3(0.638221,-0.563827,0.356589),
glm::vec3(0.342339,-0.804812,0.317296),
glm::vec3(0.673397,-0.619751,0.111561),
glm::vec3(0.733160,-0.532669,0.173077),
glm::vec3(0.687873,-0.577762,0.208232),
glm::vec3(0.797512,-0.448922,0.111561),
glm::vec3(0.741549,-0.538764,0.100879),
glm::vec3(0.707701,-0.514173,0.291182),
glm::vec3(0.762051,-0.475664,0.208231),
glm::vec3(0.839872,-0.355433,0.143752),
glm::vec3(0.793540,-0.398809,0.251895),
glm::vec3(0.733454,-0.432750,0.356589),
glm::vec3(0.861348,-0.212919,0.280082),
glm::vec3(0.818996,-0.322346,0.292400),
glm::vec3(0.860584,-0.276347,0.206508),
glm::vec3(0.842027,-0.163863,0.361489),
glm::vec3(0.832827,-0.263720,0.320613),
glm::vec3(0.808346,-0.251426,0.386086),
glm::vec3(0.771293,-0.341220,0.385089),
glm::vec3(0.894295,-0.203901,0.133374),
glm::vec3(0.890141,-0.140627,0.228667),
glm::vec3(0.871212,-0.076884,0.317294),
glm::vec3(0.285448,0.878522,0.082924),
glm::vec3(0.340549,0.846478,0.182208),
glm::vec3(0.382971,0.838987,0.095137),
glm::vec3(0.222035,0.884986,0.182208),
glm::vec3(0.183313,0.903859,0.095137),
glm::vec3(0.276651,0.851451,0.255004),
glm::vec3(0.283836,0.873560,0.149236),
glm::vec3(0.401640,0.831284,-0.005930),
glm::vec3(0.285260,0.877940,-0.007270),
glm::vec3(0.163684,0.908600,-0.005930),
glm::vec3(0.381330,0.831951,-0.111562),
glm::vec3(0.280043,0.861879,-0.173078),
glm::vec3(0.283247,0.871742,-0.100879),
glm::vec3(0.270320,0.831950,-0.291183),
glm::vec3(0.336924,0.832743,-0.208232),
glm::vec3(0.180509,0.897202,-0.111562),
glm::vec3(0.216901,0.871741,-0.208232),
glm::vec3(0.184925,0.831282,-0.356590),
glm::vec3(0.134077,0.877939,-0.251896),
glm::vec3(0.078506,0.908600,-0.143753),
glm::vec3(-0.010667,0.846477,-0.386088),
glm::vec3(0.053491,0.878520,-0.292402),
glm::vec3(0.086181,0.838985,-0.385091),
glm::vec3(-0.104354,0.851450,-0.361491),
glm::vec3(-0.006541,0.873558,-0.320615),
glm::vec3(-0.063669,0.884985,-0.280084),
glm::vec3(-0.003109,0.903859,-0.206510),
glm::vec3(0.091024,0.787511,-0.480278),
glm::vec3(-0.021694,0.803114,-0.467922),
glm::vec3(-0.130691,0.804811,-0.448102),
glm::vec3(-0.747317,0.542954,0.082924),
glm::vec3(-0.699814,0.585456,0.182208),
glm::vec3(-0.679581,0.623486,0.095137),
glm::vec3(-0.773060,0.484642,0.182208),
glm::vec3(-0.802976,0.453647,0.095137),
glm::vec3(-0.724289,0.526223,0.255004),
glm::vec3(-0.743096,0.539887,0.149236),
glm::vec3(-0.666486,0.638861,-0.005930),
glm::vec3(-0.746822,0.542595,-0.007270),
glm::vec3(-0.813551,0.436443,-0.005930),
glm::vec3(-0.673397,0.619751,-0.111561),
glm::vec3(-0.733160,0.532669,-0.173077),
glm::vec3(-0.741549,0.538764,-0.100879),
glm::vec3(-0.707701,0.514173,-0.291182),
glm::vec3(-0.687873,0.577762,-0.208232),
glm::vec3(-0.797512,0.448922,-0.111561),
glm::vec3(-0.762051,0.475664,-0.208231),
glm::vec3(-0.733454,0.432750,-0.356589),
glm::vec3(-0.793540,0.398809,-0.251895),
glm::vec3(-0.839872,0.355433,-0.143752),
glm::vec3(-0.808346,0.251426,-0.386086),
glm::vec3(-0.818996,0.322346,-0.292400),
glm::vec3(-0.771293,0.341220,-0.385089),
glm::vec3(-0.842027,0.163863,-0.361489),
glm::vec3(-0.832827,0.263720,-0.320613),
glm::vec3(-0.861348,0.212919,-0.280082),
glm::vec3(-0.860584,0.276347,-0.206508),
glm::vec3(-0.720843,0.329919,-0.480276),
glm::vec3(-0.770514,0.227540,-0.467920),
glm::vec3(-0.805809,0.124402,-0.448100),
glm::vec3(-0.747317,-0.542954,0.082924),
glm::vec3(-0.773060,-0.484642,0.182208),
glm::vec3(-0.802976,-0.453647,0.095137),
glm::vec3(-0.699814,-0.585456,0.182208),
glm::vec3(-0.679581,-0.623486,0.095137),
glm::vec3(-0.724289,-0.526223,0.255004),
glm::vec3(-0.743096,-0.539887,0.149236),
glm::vec3(-0.813551,-0.436443,-0.00593),
glm::vec3(-0.746822,-0.542595,-0.00727),
glm::vec3(-0.666486,-0.638861,-0.00593),
glm::vec3(-0.797512,-0.448922,-0.11156),
glm::vec3(-0.733160,-0.532669,-0.17307),
glm::vec3(-0.741549,-0.538764,-0.10087),
glm::vec3(-0.707701,-0.514173,-0.29118),
glm::vec3(-0.762051,-0.475664,-0.20823),
glm::vec3(-0.673397,-0.619751,-0.11156),
glm::vec3(-0.687873,-0.577762,-0.20823),
glm::vec3(-0.638221,-0.563827,-0.35658),
glm::vec3(-0.624509,-0.631460,-0.25189),
glm::vec3(-0.597574,-0.688928,-0.14375),
glm::vec3(-0.488913,-0.691086,-0.38608),
glm::vec3(-0.559654,-0.679298,-0.29240),
glm::vec3(-0.562862,-0.628099,-0.38509),
glm::vec3(-0.416042,-0.750177,-0.36149),
glm::vec3(-0.508170,-0.710570,-0.32061),
glm::vec3(-0.468669,-0.753393,-0.28008),
glm::vec3(-0.528758,-0.733066,-0.20650),
glm::vec3(-0.536525,-0.583610,-0.48027),
glm::vec3(-0.454504,-0.662487,-0.46792),
glm::vec3(-0.367320,-0.727926,-0.44810),
glm::vec3(0.285448,-0.878522,0.082924),
glm::vec3(0.222035,-0.884986,0.182208),
glm::vec3(0.183313,-0.903860,0.095137),
glm::vec3(0.340549,-0.846478,0.182208),
glm::vec3(0.382971,-0.838987,0.095137),
glm::vec3(0.276651,-0.851451,0.255004),
glm::vec3(0.283836,-0.873560,0.149236),
glm::vec3(0.163684,-0.908600,-0.005930),
glm::vec3(0.285260,-0.877940,-0.007270),
glm::vec3(0.401640,-0.831284,-0.005930),
glm::vec3(0.180509,-0.897202,-0.111562),
glm::vec3(0.280043,-0.861879,-0.173078),
glm::vec3(0.283247,-0.871742,-0.100879),
glm::vec3(0.270320,-0.831950,-0.291183),
glm::vec3(0.216901,-0.871741,-0.208232),
glm::vec3(0.381330,-0.831951,-0.111562),
glm::vec3(0.336924,-0.832743,-0.208232),
glm::vec3(0.339013,-0.781215,-0.356590),
glm::vec3(0.407573,-0.789074,-0.251896),
glm::vec3(0.470551,-0.781216,-0.143753),
glm::vec3(0.506182,-0.678540,-0.386087),
glm::vec3(0.473111,-0.742176,-0.292401),
glm::vec3(0.423427,-0.729406,-0.385091),
glm::vec3(0.584899,-0.627496,-0.361491),
glm::vec3(0.518761,-0.702876,-0.320615),
glm::vec3(0.571695,-0.678541,-0.280084),
glm::vec3(0.533794,-0.729407,-0.206510),
glm::vec3(0.389254,-0.690609,-0.480278),
glm::vec3(0.489615,-0.636978,-0.467922),
glm::vec3(0.578793,-0.574283,-0.448102),
glm::vec3(0.923734,-0.000000,0.082923),
glm::vec3(0.910286,-0.062306,0.182206),
glm::vec3(0.916270,-0.104965,0.095136),
glm::vec3(0.910286,0.062306,0.182206),
glm::vec3(0.916270,0.104965,0.095136),
glm::vec3(0.895270,0.000000,0.255003),
glm::vec3(0.918516,0.000000,0.149235),
glm::vec3(0.914713,-0.125099,-0.005930),
glm::vec3(0.923122,0.000000,-0.007270),
glm::vec3(0.914713,0.125099,-0.005930),
glm::vec3(0.909072,-0.105576,-0.111561),
glm::vec3(0.906235,0.000000,-0.173077),
glm::vec3(0.916605,0.000000,-0.100879),
glm::vec3(0.874767,-0.000000,-0.291182),
glm::vec3(0.896102,-0.063099,-0.208232),
glm::vec3(0.909072,0.105576,-0.111561),
glm::vec3(0.896102,0.063099,-0.208232),
glm::vec3(0.847742,0.081008,-0.356589),
glm::vec3(0.876403,0.143784,-0.251896),
glm::vec3(0.888391,0.206108,-0.143753),
glm::vec3(0.801752,0.271722,-0.386087),
glm::vec3(0.852053,0.220605,-0.292401),
glm::vec3(0.824554,0.177299,-0.385090),
glm::vec3(0.777531,0.362359,-0.361491),
glm::vec3(0.828783,0.276165,-0.320615),
glm::vec3(0.821997,0.334028,-0.280083),
glm::vec3(0.858661,0.282264,-0.206509),
glm::vec3(0.777097,0.156788,-0.480278),
glm::vec3(0.757104,0.268809,-0.467921),
glm::vec3(0.725036,0.372995,-0.448102),
glm::vec3(0.408379,0.542952,-0.631341),
glm::vec3(0.508692,0.484640,-0.609966),
glm::vec3(0.444193,0.453645,-0.675662),
glm::vec3(0.475936,0.585455,-0.544453),
glm::vec3(0.389010,0.623484,-0.565294),
glm::vec3(0.551992,0.526222,-0.533789),
glm::vec3(0.465802,0.539885,-0.597910),
glm::vec3(0.358527,0.436441,-0.730318),
glm::vec3(0.496449,0.360688,-0.694674),
glm::vec3(0.327487,0.542592,-0.671233),
glm::vec3(0.563546,0.409436,-0.615787),
glm::vec3(0.292759,0.638858,-0.598780),
glm::vec3(0.619213,0.449880,-0.528944),
glm::vec3(0.256876,0.448920,-0.763211),
glm::vec3(0.173077,0.532667,-0.733164),
glm::vec3(0.241404,0.538762,-0.708380),
glm::vec3(0.056057,0.514171,-0.763211),
glm::vec3(0.154555,0.475662,-0.774727),
glm::vec3(0.201372,0.619748,-0.652201),
glm::vec3(0.121382,0.577760,-0.708380),
glm::vec3(-0.033515,0.563824,-0.730318),
glm::vec3(0.053992,0.631458,-0.671234),
glm::vec3(0.138671,0.688925,-0.598780),
glm::vec3(-0.126669,0.691085,-0.609966),
glm::vec3(-0.011239,0.679296,-0.631341),
glm::vec3(-0.092707,0.628097,-0.675662),
glm::vec3(-0.137258,0.750176,-0.533789),
glm::vec3(-0.059498,0.710568,-0.597910),
glm::vec3(-0.040912,0.753391,-0.544453),
glm::vec3(0.051766,0.733063,-0.565294),
glm::vec3(-0.189623,0.583609,-0.694674),
glm::vec3(-0.215252,0.662486,-0.615788),
glm::vec3(-0.236514,0.727926,-0.528944),
glm::vec3(-0.390184,0.556171,-0.631340),
glm::vec3(-0.303727,0.633555,-0.609966),
glm::vec3(-0.294180,0.562635,-0.675661),
glm::vec3(-0.409730,0.633556,-0.544452),
glm::vec3(-0.472760,0.562636,-0.565294),
glm::vec3(-0.329893,0.687586,-0.533789),
glm::vec3(-0.369522,0.609835,-0.597910),
glm::vec3(-0.304290,0.475845,-0.730317),
glm::vec3(-0.414839,0.479126,-0.671233),
glm::vec3(-0.517126,0.475846,-0.598779),
glm::vec3(-0.347571,0.383025,-0.763210),
glm::vec3(-0.453115,0.329207,-0.733163),
glm::vec3(-0.437798,0.396073,-0.708379),
glm::vec3(-0.471686,0.212199,-0.763210),
glm::vec3(-0.404624,0.293976,-0.774725),
glm::vec3(-0.527191,0.383026,-0.652200),
glm::vec3(-0.511976,0.293976,-0.708379),
glm::vec3(-0.546589,0.142354,-0.730316),
glm::vec3(-0.583871,0.246477,-0.671232),
glm::vec3(-0.612359,0.344770,-0.598778),
glm::vec3(-0.696407,0.093084,-0.609963),
glm::vec3(-0.649526,0.199221,-0.631338),
glm::vec3(-0.626007,0.105920,-0.675659),
glm::vec3(-0.755878,0.101273,-0.533786),
glm::vec3(-0.694179,0.162988,-0.597908),
glm::vec3(-0.729164,0.193898,-0.544450),
glm::vec3(-0.681191,0.275758,-0.565292),
glm::vec3(-0.613645,0.000000,-0.694671),
glm::vec3(-0.696581,0.000000,-0.615785),
glm::vec3(-0.765388,-0.000000,-0.52894),
glm::vec3(-0.649526,-0.199221,-0.63133),
glm::vec3(-0.696407,-0.093084,-0.60996),
glm::vec3(-0.626007,-0.105920,-0.67565),
glm::vec3(-0.729164,-0.193898,-0.54445),
glm::vec3(-0.681191,-0.275758,-0.56529),
glm::vec3(-0.755878,-0.101273,-0.53378),
glm::vec3(-0.694179,-0.162988,-0.59790),
glm::vec3(-0.546589,-0.142354,-0.73031),
glm::vec3(-0.583871,-0.246477,-0.67123),
glm::vec3(-0.612359,-0.344770,-0.59877),
glm::vec3(-0.471686,-0.212199,-0.76321),
glm::vec3(-0.453115,-0.329207,-0.73316),
glm::vec3(-0.511976,-0.293976,-0.70837),
glm::vec3(-0.347571,-0.383025,-0.76321),
glm::vec3(-0.404624,-0.293976,-0.77472),
glm::vec3(-0.527191,-0.383026,-0.65220),
glm::vec3(-0.437798,-0.396073,-0.70837),
glm::vec3(-0.304290,-0.475845,-0.73031),
glm::vec3(-0.414839,-0.479126,-0.67123),
glm::vec3(-0.517126,-0.475846,-0.59877),
glm::vec3(-0.303727,-0.633556,-0.60996),
glm::vec3(-0.390184,-0.556171,-0.63134),
glm::vec3(-0.294180,-0.562635,-0.67566),
glm::vec3(-0.329893,-0.687586,-0.53378),
glm::vec3(-0.369522,-0.609836,-0.59791),
glm::vec3(-0.409730,-0.633556,-0.54445),
glm::vec3(-0.472760,-0.562636,-0.56529),
glm::vec3(-0.189623,-0.583609,-0.69467),
glm::vec3(-0.215252,-0.662486,-0.61578),
glm::vec3(-0.236514,-0.727926,-0.52894),
glm::vec3(0.642577,0.220605,-0.631340),
glm::vec3(0.703876,0.271721,-0.544452),
glm::vec3(0.713182,0.177299,-0.565293),
glm::vec3(0.618118,0.334027,-0.609965),
glm::vec3(0.568709,0.282263,-0.675661),
glm::vec3(0.671045,0.362358,-0.533788),
glm::vec3(0.657405,0.276164,-0.597910),
glm::vec3(0.698060,0.081008,-0.598779),
glm::vec3(0.617237,0.143784,-0.671233),
glm::vec3(0.525873,0.206107,-0.730317),
glm::vec3(0.651644,0.000000,-0.652200),
glm::vec3(0.560082,0.000000,-0.733164),
glm::vec3(0.586993,0.063099,-0.708379),
glm::vec3(0.506329,-0.105576,-0.763211),
glm::vec3(0.586993,-0.063099,-0.708380),
glm::vec3(0.506329,0.105576,-0.763211),
glm::vec3(0.500144,-0.000000,-0.774726),
glm::vec3(0.414373,-0.125099,-0.815495),
glm::vec3(0.419333,-0.000000,-0.822417),
glm::vec3(0.414373,0.125099,-0.815495),
glm::vec3(0.244121,-0.062306,-0.895671),
glm::vec3(0.338936,0.000000,-0.863299),
glm::vec3(0.324675,-0.104965,-0.862085),
glm::vec3(0.172296,-0.000000,-0.914796),
glm::vec3(0.277292,0.000000,-0.888288),
glm::vec3(0.244121,0.062306,-0.895671),
glm::vec3(0.324675,0.104965,-0.862085),
glm::vec3(-0.011239,-0.679296,-0.63134),
glm::vec3(-0.126669,-0.691084,-0.60996),
glm::vec3(-0.092707,-0.628097,-0.67566),
glm::vec3(-0.040912,-0.753391,-0.54445),
glm::vec3(0.051766,-0.733063,-0.565294),
glm::vec3(-0.137258,-0.750176,-0.53378),
glm::vec3(-0.059498,-0.710568,-0.59791),
glm::vec3(-0.033515,-0.563824,-0.73031),
glm::vec3(0.053992,-0.631458,-0.671233),
glm::vec3(0.138671,-0.688925,-0.598780),
glm::vec3(0.056057,-0.514171,-0.763211),
glm::vec3(0.173077,-0.532667,-0.733164),
glm::vec3(0.121382,-0.577760,-0.708380),
glm::vec3(0.256876,-0.448920,-0.763211),
glm::vec3(0.154555,-0.475662,-0.774727),
glm::vec3(0.201372,-0.619748,-0.652201),
glm::vec3(0.241404,-0.538762,-0.708380),
glm::vec3(0.358527,-0.436441,-0.730318),
glm::vec3(0.327487,-0.542592,-0.671234),
glm::vec3(0.292759,-0.638858,-0.598780),
glm::vec3(0.508692,-0.484640,-0.609966),
glm::vec3(0.408379,-0.542952,-0.631341),
glm::vec3(0.444193,-0.453645,-0.675662),
glm::vec3(0.551992,-0.526222,-0.533789),
glm::vec3(0.465802,-0.539885,-0.597910),
glm::vec3(0.475937,-0.585455,-0.544453),
glm::vec3(0.389010,-0.623484,-0.565294)
		},
		{
			0,1,2   ,
3,4,5   ,
2,3,6   ,
7,8,9   ,
7,4,0   ,
8,2,10  ,
11,12,13,
14,5,11 ,
5,15,12 ,
16,17,18,
10,6,16 ,
6,14,17 ,
19,20,21                          ,
22,23,24                          ,
21,22,25                          ,
26,27,28                          ,
26,23,19                          ,
27,21,29                          ,
30,31,13                          ,
32,24,30                          ,
24,33,31                          ,
34,35,36                          ,
29,25,34                          ,
25,32,35                          ,
37,38,39                          ,
40,41,42                          ,
39,40,43                          ,
8,44,9                            ,
8,41,37                           ,
44,39,45                          ,
46,16,18                          ,
47,42,46                          ,
42,10,16                          ,
48,49,50                          ,
45,43,48                          ,
43,47,49                          ,
51,52,53                          ,
54,55,56                          ,
53,54,57                          ,
44,58,9                           ,
44,55,51                          ,
58,53,59                          ,
60,48,50                          ,
61,56,60                          ,
56,45,48                          ,
62,63,64                          ,
59,57,62                          ,
57,61,63                          ,
65,66,67                          ,
68,69,70                          ,
67,68,71                          ,
58,72,9                           ,
58,69,65                          ,
72,67,73                          ,
74,62,64                          ,
75,70,74                          ,
70,59,62                          ,
76,77,78                          ,
73,71,76                          ,
71,75,77                          ,
79,80,81                          ,
82,83,84                          ,
81,82,85                          ,
27,86,28                          ,
27,83,79                          ,
86,81,87                          ,
88,34,36                          ,
89,84,88                          ,
84,29,34                          ,
90,91,92                          ,
87,85,90                          ,
85,89,91                          ,
93,94,95                          ,
96,97,98                          ,
95,96,99                          ,
100,101,102                       ,
100,97,93                         ,
101,95,103                        ,
104,105,106                       ,
107,98,104                        ,
98,108,105                        ,
109,110,111                       ,
103,99,109                        ,
99,107,110                        ,
112,113,114                       ,
115,116,117                       ,
114,115,118                       ,
119,120,121                       ,
119,116,112                       ,
120,114,122                       ,
123,124,125                       ,
126,117,123                       ,
117,127,124                       ,
128,129,130                       ,
122,118,128                       ,
118,126,129                       ,
131,132,133                       ,
134,135,136                       ,
133,134,137                       ,
138,139,140                       ,
138,135,131                       ,
139,133,141                       ,
142,143,144                       ,
145,136,142                       ,
136,146,143                       ,
147,148,149                       ,
141,137,147                       ,
137,145,148                       ,
150,151,152                       ,
153,154,155                       ,
152,153,156                       ,
157,158,159                       ,
157,154,150                       ,
158,152,160                       ,
161,162,163                       ,
164,155,161                       ,
155,165,162                       ,
166,167,168                       ,
160,156,166                       ,
156,164,167                       ,
169,170,171                       ,
172,173,174                       ,
171,172,175                       ,
86,176,28                         ,
86,173,169                        ,
176,171,177                       ,
178,90,92                         ,
179,174,178                       ,
174,87,90                         ,
180,181,182                       ,
177,175,180                       ,
175,179,181                       ,
183,184,185                       ,
186,187,188                       ,
185,186,189                       ,
101,190,102                       ,
101,187,183                       ,
190,185,191                       ,
192,109,111                       ,
193,188,192                       ,
188,103,109                       ,
194,195,196                       ,
191,189,194                       ,
189,193,195                       ,
197,198,199                       ,
200,201,202                       ,
199,200,203                       ,
120,204,121                       ,
120,201,197                       ,
204,199,205                       ,
206,128,130                       ,
207,202,206                       ,
202,122,128                       ,
208,209,210                       ,
205,203,208                       ,
203,207,209                       ,
211,212,213                       ,
214,215,216                       ,
213,214,217                       ,
139,218,140                       ,
139,215,211                       ,
218,213,219                       ,
220,147,149                       ,
221,216,220                       ,
216,141,147                       ,
222,223,224                       ,
219,217,222                       ,
217,221,223                       ,
225,226,227                       ,
228,229,230                       ,
227,228,231                       ,
158,232,159                       ,
158,229,225                       ,
232,227,233                       ,
234,166,168                       ,
235,230,234                       ,
230,160,166                       ,
236,237,238                       ,
233,231,236                       ,
231,235,237                       ,
239,240,241                       ,
242,243,244                       ,
241,242,245                       ,
246,247,248                       ,
246,243,239                       ,
247,241,249                       ,
250,251,252                       ,
253,244,250                       ,
244,254,251                       ,
255,256,257                       ,
249,245,255                       ,
245,253,256                       ,
258,259,260                       ,
261,262,263                       ,
260,261,264                       ,
265,266,267                       ,
265,262,258                       ,
266,260,268                       ,
269,270,271                       ,
272,263,269                       ,
263,273,270                       ,
274,275,276                       ,
268,264,274                       ,
264,272,275                       ,
277,278,279                       ,
280,281,282                       ,
279,280,283                       ,
284,285,286                       ,
284,281,277                       ,
285,279,287                       ,
288,289,290                       ,
291,282,288                       ,
282,292,289                       ,
293,294,295                       ,
287,283,293                       ,
283,291,294                       ,
296,297,298                       ,
299,300,301                       ,
298,299,302                       ,
303,304,305                       ,
303,300,296                       ,
304,298,306                       ,
307,308,309                       ,
310,301,307                       ,
301,311,308                       ,
312,313,314                       ,
306,302,312                       ,
302,310,313                       ,
315,316,317                       ,
318,319,320                       ,
317,318,321                       ,
322,323,324                       ,
322,319,315                       ,
323,317,325                       ,
326,327,328                       ,
329,320,326                       ,
320,330,327                       ,
331,332,333                       ,
325,321,331                       ,
321,329,332                       ,
334,335,336                       ,
337,334,338                       ,
339,340,337                       ,
341,342,333                       ,
343,336,341                       ,
336,344,342                       ,
345,346,314                       ,
347,338,345                       ,
338,343,346                       ,
348,349,350                       ,
348,335,339                       ,
349,337,347                       ,
351,352,353                       ,
354,352,355                       ,
356,352,357                       ,
332,341,333                       ,
329,351,332                       ,
351,343,341                       ,
358,326,328                       ,
359,354,358                       ,
354,329,326                       ,
346,360,314                       ,
343,356,346                       ,
356,359,360                       ,
361,362,363                       ,
364,365,361                       ,
362,366,367                       ,
368,358,328                       ,
369,363,368                       ,
363,359,358                       ,
304,370,305                       ,
304,366,364                       ,
370,361,369                       ,
360,312,314                       ,
359,367,360                       ,
367,306,312                       ,
371,372,373                       ,
374,371,375                       ,
376,377,374                       ,
378,345,314                       ,
379,373,378                       ,
373,347,345                       ,
380,381,295                       ,
382,375,380                       ,
375,379,381                       ,
349,383,350                       ,
349,372,376                       ,
383,374,382                       ,
384,385,386                       ,
387,385,388                       ,
389,385,390                       ,
313,378,314                       ,
310,384,313                       ,
384,379,378                       ,
391,307,309                       ,
392,387,391                       ,
387,310,307                       ,
381,393,295                       ,
379,389,381                       ,
389,392,393                       ,
394,395,396                       ,
397,398,394                       ,
395,399,400                       ,
401,391,309                       ,
402,396,401                       ,
396,392,391                       ,
285,403,286                       ,
285,399,397                       ,
403,394,402                       ,
393,293,295                       ,
392,400,393                       ,
400,287,293                       ,
404,405,406                       ,
407,404,408                       ,
409,410,407                       ,
411,380,295                       ,
412,406,411                       ,
406,382,380                       ,
413,414,276                       ,
415,408,413                       ,
408,412,414                       ,
383,416,350                       ,
383,405,409                       ,
416,407,415                       ,
417,418,419                       ,
420,418,421                       ,
422,418,423                       ,
294,411,295                       ,
291,417,294                       ,
417,412,411                       ,
424,288,290                       ,
425,420,424                       ,
420,291,288                       ,
414,426,276                       ,
412,422,414                       ,
422,425,426                       ,
427,428,429                       ,
430,431,427                       ,
428,432,433                       ,
434,424,290                       ,
435,429,434                       ,
429,425,424                       ,
266,436,267                       ,
266,432,430                       ,
436,427,435                       ,
426,274,276                       ,
425,433,426                       ,
433,268,274                       ,
437,438,439                       ,
440,437,441                       ,
442,443,440                       ,
444,413,276                       ,
445,439,444                       ,
439,415,413                       ,
446,447,257                       ,
448,441,446                       ,
441,445,447                       ,
416,449,350                       ,
416,438,442                       ,
449,440,448                       ,
450,451,452                       ,
453,451,454                       ,
455,451,456                       ,
275,444,276                       ,
272,450,275                       ,
450,445,444                       ,
457,269,271                       ,
458,453,457                       ,
453,272,269                       ,
447,459,257                       ,
445,455,447                       ,
455,458,459                       ,
460,461,462                       ,
463,464,460                       ,
461,465,466                       ,
467,457,271                       ,
468,462,467                       ,
462,458,457                       ,
247,469,248                       ,
247,465,463                       ,
469,460,468                       ,
459,255,257                       ,
458,466,459                       ,
466,249,255                       ,
470,471,472                       ,
473,470,474                       ,
475,476,473                       ,
477,446,257                       ,
478,472,477                       ,
472,448,446                       ,
342,479,333                       ,
344,474,342                       ,
474,478,479                       ,
449,348,350                       ,
449,471,475                       ,
348,473,344                       ,
480,481,482                       ,
483,481,484                       ,
485,481,486                       ,
256,477,257                       ,
253,480,256                       ,
480,478,477                       ,
487,250,252                       ,
488,483,487                       ,
483,253,250                       ,
479,489,333                       ,
478,485,479                       ,
485,488,489                       ,
490,491,492                       ,
493,494,490                       ,
491,495,496                       ,
497,487,252                       ,
498,492,497                       ,
492,488,487                       ,
323,499,324                       ,
323,495,493                       ,
499,490,498                       ,
489,331,333                       ,
488,496,489                       ,
496,325,331                       ,
500,501,502                       ,
503,500,504                       ,
505,506,503                       ,
507,508,238                       ,
509,502,507                       ,
502,510,508                       ,
327,511,328                       ,
330,504,327                       ,
504,509,511                       ,
512,322,324                       ,
512,501,505                       ,
322,503,330                       ,
513,514,515                       ,
516,514,517                       ,
518,514,519                       ,
237,507,238                       ,
235,513,237                       ,
513,509,507                       ,
520,234,168                       ,
521,516,520                       ,
516,235,234                       ,
511,522,328                       ,
509,518,511                       ,
518,521,522                       ,
523,524,525                       ,
526,527,523                       ,
524,528,529                       ,
530,520,168                       ,
531,525,530                       ,
525,521,520                       ,
370,532,305                       ,
370,528,526                       ,
532,523,531                       ,
522,368,328                       ,
521,529,522                       ,
529,369,368                       ,
533,534,535                       ,
536,533,537                       ,
538,539,536                       ,
540,541,224                       ,
542,535,540                       ,
535,543,541                       ,
308,544,309                       ,
311,537,308                       ,
537,542,544                       ,
545,303,305                       ,
545,534,538                       ,
303,536,311                       ,
546,547,548                       ,
549,547,550                       ,
551,547,552                       ,
223,540,224                       ,
221,546,223                       ,
546,542,540                       ,
553,220,149                       ,
554,549,553                       ,
549,221,220                       ,
544,555,309                       ,
542,551,544                       ,
551,554,555                       ,
556,557,558                       ,
559,560,556                       ,
557,561,562                       ,
563,553,149                       ,
564,558,563                       ,
558,554,553                       ,
403,565,286                       ,
403,561,559                       ,
565,556,564                       ,
555,401,309                       ,
554,562,555                       ,
562,402,401                       ,
566,567,568                       ,
569,566,570                       ,
571,572,569                       ,
573,574,210                       ,
575,568,573                       ,
568,576,574                       ,
289,577,290                       ,
292,570,289                       ,
570,575,577                       ,
578,284,286                       ,
578,567,571                       ,
284,569,292                       ,
579,580,581                       ,
582,580,583                       ,
584,580,585                       ,
209,573,210                       ,
207,579,209                       ,
579,575,573                       ,
586,206,130                       ,
587,582,586                       ,
582,207,206                       ,
577,588,290                       ,
575,584,577                       ,
584,587,588                       ,
589,590,591                       ,
592,593,589                       ,
590,594,595                       ,
596,586,130                       ,
597,591,596                       ,
591,587,586                       ,
436,598,267                       ,
436,594,592                       ,
598,589,597                       ,
588,434,290                       ,
587,595,588                       ,
595,435,434                       ,
599,600,601                       ,
602,599,603                       ,
604,605,602                       ,
606,607,196                       ,
608,601,606                       ,
601,609,607                       ,
270,610,271                       ,
273,603,270                       ,
603,608,610                       ,
611,265,267                       ,
611,600,604                       ,
265,602,273                       ,
612,613,614                       ,
615,613,616                       ,
617,613,618                       ,
195,606,196                       ,
193,612,195                       ,
612,608,606                       ,
619,192,111                       ,
620,615,619                       ,
615,193,192                       ,
610,621,271                       ,
608,617,610                       ,
617,620,621                       ,
622,623,624                       ,
625,626,622                       ,
623,627,628                       ,
629,619,111                       ,
630,624,629                       ,
624,620,619                       ,
469,631,248                       ,
469,627,625                       ,
631,622,630                       ,
621,467,271                       ,
620,628,621                       ,
628,468,467                       ,
632,633,634                       ,
635,632,636                       ,
637,638,635                       ,
639,640,182                       ,
641,634,639                       ,
634,642,640                       ,
251,643,252                       ,
254,636,251                       ,
636,641,643                       ,
644,246,248                       ,
644,633,637                       ,
246,635,254                       ,
645,646,647                       ,
648,646,649                       ,
650,646,651                       ,
181,639,182                       ,
179,645,181                       ,
645,641,639                       ,
652,178,92                        ,
653,648,652                       ,
648,179,178                       ,
643,654,252                       ,
641,650,643                       ,
650,653,654                       ,
655,656,657                       ,
658,659,655                       ,
656,660,661                       ,
662,652,92                        ,
663,657,662                       ,
657,653,652                       ,
499,664,324                       ,
499,660,658                       ,
664,655,663                       ,
654,497,252                       ,
653,661,654                       ,
661,498,497                       ,
665,666,667                       ,
668,665,669                       ,
670,671,668                       ,
672,530,168                       ,
673,667,672                       ,
667,531,530                       ,
541,674,224                       ,
543,669,541                       ,
669,673,674                       ,
532,545,305                       ,
532,666,670                       ,
545,668,543                       ,
675,676,677                       ,
678,676,679                       ,
680,676,681                       ,
167,672,168                       ,
164,675,167                       ,
675,673,672                       ,
682,161,163                       ,
683,678,682                       ,
678,164,161                       ,
674,684,224                       ,
673,680,674                       ,
680,683,684                       ,
685,686,687                       ,
688,689,685                       ,
686,690,691                       ,
692,682,163                       ,
693,687,692                       ,
687,683,682                       ,
218,694,140                       ,
218,690,688                       ,
694,685,693                       ,
684,222,224                       ,
683,691,684                       ,
691,219,222                       ,
695,696,697                       ,
698,695,699                       ,
700,701,698                       ,
702,563,149                       ,
703,697,702                       ,
697,564,563                       ,
574,704,210                       ,
576,699,574                       ,
699,703,704                       ,
565,578,286                       ,
565,696,700                       ,
578,698,576                       ,
705,706,707                       ,
708,706,709                       ,
710,706,711                       ,
148,702,149                       ,
145,705,148                       ,
705,703,702                       ,
712,142,144                       ,
713,708,712                       ,
708,145,142                       ,
704,714,210                       ,
703,710,704                       ,
710,713,714                       ,
715,716,717                       ,
718,719,715                       ,
716,720,721                       ,
722,712,144                       ,
723,717,722                       ,
717,713,712                       ,
204,724,121                       ,
204,720,718                       ,
724,715,723                       ,
714,208,210                       ,
713,721,714                       ,
721,205,208                       ,
725,726,727                       ,
728,725,729                       ,
730,731,728                       ,
732,596,130                       ,
733,727,732                       ,
727,597,596                       ,
607,734,196                       ,
609,729,607                       ,
729,733,734                       ,
598,611,267                       ,
598,726,730                       ,
611,728,609                       ,
735,736,737                       ,
738,736,739                       ,
740,736,741                       ,
129,732,130                       ,
126,735,129                       ,
735,733,732                       ,
742,123,125                       ,
743,738,742                       ,
738,126,123                       ,
734,744,196                       ,
733,740,734                       ,
740,743,744                       ,
745,746,747                       ,
748,749,745                       ,
746,750,751                       ,
752,742,125                       ,
753,747,752                       ,
747,743,742                       ,
190,754,102                       ,
190,750,748                       ,
754,745,753                       ,
744,194,196                       ,
743,751,744                       ,
751,191,194                       ,
755,756,757                       ,
758,755,759                       ,
760,761,758                       ,
762,629,111                       ,
763,757,762                       ,
757,630,629                       ,
640,764,182                       ,
642,759,640                       ,
759,763,764                       ,
631,644,248                       ,
631,756,760                       ,
644,758,642                       ,
765,766,767                       ,
768,766,769                       ,
770,766,771                       ,
110,762,111                       ,
107,765,110                       ,
765,763,762                       ,
772,104,106                       ,
773,768,772                       ,
768,107,104                       ,
764,774,182                       ,
763,770,764                       ,
770,773,774                       ,
775,776,777                       ,
778,779,775                       ,
776,780,781                       ,
782,772,106                       ,
783,777,782                       ,
777,773,772                       ,
176,784,28                        ,
176,780,778                       ,
784,775,783                       ,
774,180,182                       ,
773,781,774                       ,
781,177,180                       ,
785,786,787                       ,
788,785,789                       ,
790,791,788                       ,
792,662,92                        ,
793,787,792                       ,
787,663,662                       ,
508,794,238                       ,
510,789,508                       ,
789,793,794                       ,
664,512,324                       ,
664,786,790                       ,
512,788,510                       ,
795,796,797                       ,
798,796,799                       ,
800,796,801                       ,
91,792,92                         ,
89,795,91                         ,
795,793,792                       ,
802,88,36                         ,
803,798,802                       ,
798,89,88                         ,
794,804,238                       ,
793,800,794                       ,
800,803,804                       ,
805,806,807                       ,
808,809,805                       ,
806,810,811                       ,
812,802,36                        ,
813,807,812                       ,
807,803,802                       ,
232,814,159                       ,
232,810,808                       ,
814,805,813                       ,
804,236,238                       ,
803,811,804                       ,
811,233,236                       ,
815,816,817                       ,
818,815,819                       ,
820,821,818                       ,
822,823,78                        ,
824,817,822                       ,
817,825,823                       ,
162,826,163                       ,
165,819,162                       ,
819,824,826                       ,
827,157,159                       ,
827,816,820                       ,
157,818,165                       ,
828,829,830                       ,
831,829,832                       ,
833,829,834                       ,
77,822,78                         ,
75,828,77                         ,
828,824,822                       ,
835,74,64                         ,
836,831,835                       ,
831,75,74                         ,
826,837,163                       ,
824,833,826                       ,
833,836,837                       ,
838,839,840                       ,
841,842,838                       ,
839,843,844                       ,
845,835,64                        ,
846,840,845                       ,
840,836,835                       ,
694,847,140                       ,
694,843,841                       ,
847,838,846                       ,
837,692,163                       ,
836,844,837                       ,
844,693,692                       ,
848,849,850                       ,
851,848,852                       ,
853,854,851                       ,
855,845,64                        ,
856,850,855                       ,
850,846,845                       ,
143,857,144                       ,
146,852,143                       ,
852,856,857                       ,
847,138,140                       ,
847,849,853                       ,
138,851,146                       ,
858,859,860                       ,
861,859,862                       ,
863,859,864                       ,
63,855,64                         ,
61,858,63                         ,
858,856,855                       ,
865,60,50                         ,
866,861,865                       ,
861,61,60                         ,
857,867,144                       ,
856,863,857                       ,
863,866,867                       ,
868,869,870                       ,
871,872,868                       ,
869,873,874                       ,
875,865,50                        ,
876,870,875                       ,
870,866,865                       ,
724,877,121                       ,
724,873,871                       ,
877,868,876                       ,
867,722,144                       ,
866,874,867                       ,
874,723,722                       ,
878,879,880                       ,
881,878,882                       ,
883,884,881                       ,
885,875,50                        ,
886,880,885                       ,
880,876,875                       ,
124,887,125                       ,
127,882,124                       ,
882,886,887                       ,
877,119,121                       ,
877,879,883                       ,
119,881,127                       ,
888,889,890                       ,
891,889,892                       ,
893,889,894                       ,
49,885,50                         ,
47,888,49                         ,
888,886,885                       ,
895,46,18                         ,
896,891,895                       ,
891,47,46                         ,
887,897,125                       ,
886,893,887                       ,
893,896,897                       ,
898,899,900                       ,
901,902,898                       ,
899,903,904                       ,
905,895,18                        ,
906,900,905                       ,
900,896,895                       ,
754,907,102                       ,
754,903,901                       ,
907,898,906                       ,
897,752,125                       ,
896,904,897                       ,
904,753,752                       ,
908,909,910                       ,
911,908,912                       ,
913,914,911                       ,
915,812,36                        ,
916,910,915                       ,
910,813,812                       ,
823,917,78                        ,
825,912,823                       ,
912,916,917                       ,
814,827,159                       ,
814,909,913                       ,
827,911,825                       ,
918,919,920                       ,
921,919,922                       ,
923,919,924                       ,
35,915,36                         ,
32,918,35                         ,
918,916,915                       ,
925,30,13                         ,
926,921,925                       ,
921,32,30                         ,
917,927,78                        ,
916,923,917                       ,
923,926,927                       ,
928,929,930                       ,
931,932,928                       ,
929,933,934                       ,
12,925,13                         ,
15,930,12                         ,
930,926,925                       ,
72,7,9                            ,
72,933,931                        ,
7,928,15                          ,
927,76,78                         ,
926,934,927                       ,
934,73,76                         ,
935,936,937                       ,
938,935,939                       ,
940,941,938                       ,
942,905,18                        ,
943,937,942                       ,
937,906,905                       ,
105,944,106                       ,
108,939,105                       ,
939,943,944                       ,
907,100,102                       ,
907,936,940                       ,
100,938,108                       ,
945,946,947                       ,
948,946,949                       ,
950,946,951                       ,
17,942,18                         ,
14,945,17                         ,
945,943,942                       ,
952,11,13                         ,
953,948,952                       ,
948,14,11                         ,
944,954,106                       ,
943,950,944                       ,
950,953,954                       ,
955,956,957                       ,
958,959,955                       ,
956,960,961                       ,
31,952,13                         ,
33,957,31                         ,
957,953,952                       ,
784,26,28                         ,
784,960,958                       ,
26,955,33                         ,
954,782,106                       ,
953,961,954                       ,
961,783,782                       ,
0,4,1                             ,
3,1,4                             ,
2,1,3                             ,
7,0,8                             ,
7,15,4                            ,
8,0,2                             ,
11,5,12                           ,
14,3,5                            ,
5,4,15                            ,
16,6,17                           ,
10,2,6                            ,
6,3,14                            ,
19,23,20                          ,
22,20,23                          ,
21,20,22                          ,
26,19,27                          ,
26,33,23                          ,
27,19,21                          ,
30,24,31                          ,
32,22,24                          ,
24,23,33                          ,
34,25,35                          ,
29,21,25                          ,
25,22,32                          ,
37,41,38                          ,
40,38,41                          ,
39,38,40                          ,
8,37,44                           ,
8,10,41                           ,
44,37,39                          ,
46,42,16                          ,
47,40,42                          ,
42,41,10                          ,
48,43,49                          ,
45,39,43                          ,
43,40,47                          ,
51,55,52                          ,
54,52,55                          ,
53,52,54                          ,
44,51,58                          ,
44,45,55                          ,
58,51,53                          ,
60,56,48                          ,
61,54,56                          ,
56,55,45                          ,
62,57,63                          ,
59,53,57                          ,
57,54,61                          ,
65,69,66                          ,
68,66,69                          ,
67,66,68                          ,
58,65,72                          ,
58,59,69                          ,
72,65,67                          ,
74,70,62                          ,
75,68,70                          ,
70,69,59                          ,
76,71,77                          ,
73,67,71                          ,
71,68,75                          ,
79,83,80                          ,
82,80,83                          ,
81,80,82                          ,
27,79,86                          ,
27,29,83                          ,
86,79,81                          ,
88,84,34                          ,
89,82,84                          ,
84,83,29                          ,
90,85,91                          ,
87,81,85                          ,
85,82,89                          ,
93,97,94                          ,
96,94,97                          ,
95,94,96                          ,
100,93,101                        ,
100,108,97                        ,
101,93,95                         ,
104,98,105                        ,
107,96,98                         ,
98,97,108                         ,
109,99,110                        ,
103,95,99                         ,
99,96,107                         ,
112,116,113                       ,
115,113,116                       ,
114,113,115                       ,
119,112,120                       ,
119,127,116                       ,
120,112,114                       ,
123,117,124                       ,
126,115,117                       ,
117,116,127                       ,
128,118,129                       ,
122,114,118                       ,
118,115,126                       ,
131,135,132                       ,
134,132,135                       ,
133,132,134                       ,
138,131,139                       ,
138,146,135                       ,
139,131,133                       ,
142,136,143                       ,
145,134,136                       ,
136,135,146                       ,
147,137,148                       ,
141,133,137                       ,
137,134,145                       ,
150,154,151                       ,
153,151,154                       ,
152,151,153                       ,
157,150,158                       ,
157,165,154                       ,
158,150,152                       ,
161,155,162                       ,
164,153,155                       ,
155,154,165                       ,
166,156,167                       ,
160,152,156                       ,
156,153,164                       ,
169,173,170                       ,
172,170,173                       ,
171,170,172                       ,
86,169,176                        ,
86,87,173                         ,
176,169,171                       ,
178,174,90                        ,
179,172,174                       ,
174,173,87                        ,
180,175,181                       ,
177,171,175                       ,
175,172,179                       ,
183,187,184                       ,
186,184,187                       ,
185,184,186                       ,
101,183,190                       ,
101,103,187                       ,
190,183,185                       ,
192,188,109                       ,
193,186,188                       ,
188,187,103                       ,
194,189,195                       ,
191,185,189                       ,
189,186,193                       ,
197,201,198                       ,
200,198,201                       ,
199,198,200                       ,
120,197,204                       ,
120,122,201                       ,
204,197,199                       ,
206,202,128                       ,
207,200,202                       ,
202,201,122                       ,
208,203,209                       ,
205,199,203                       ,
203,200,207                       ,
211,215,212                       ,
214,212,215                       ,
213,212,214                       ,
139,211,218                       ,
139,141,215                       ,
218,211,213                       ,
220,216,147                       ,
221,214,216                       ,
216,215,141                       ,
222,217,223                       ,
219,213,217                       ,
217,214,221                       ,
225,229,226                       ,
228,226,229                       ,
227,226,228                       ,
158,225,232                       ,
158,160,229                       ,
232,225,227                       ,
234,230,166                       ,
235,228,230                       ,
230,229,160                       ,
236,231,237                       ,
233,227,231                       ,
231,228,235                       ,
239,243,240                       ,
242,240,243                       ,
241,240,242                       ,
246,239,247                       ,
246,254,243                       ,
247,239,241                       ,
250,244,251                       ,
253,242,244                       ,
244,243,254                       ,
255,245,256                       ,
249,241,245                       ,
245,242,253                       ,
258,262,259                       ,
261,259,262                       ,
260,259,261                       ,
265,258,266                       ,
265,273,262                       ,
266,258,260                       ,
269,263,270                       ,
272,261,263                       ,
263,262,273                       ,
274,264,275                       ,
268,260,264                       ,
264,261,272                       ,
277,281,278                       ,
280,278,281                       ,
279,278,280                       ,
284,277,285                       ,
284,292,281                       ,
285,277,279                       ,
288,282,289                       ,
291,280,282                       ,
282,281,292                       ,
293,283,294                       ,
287,279,283                       ,
283,280,291                       ,
296,300,297                       ,
299,297,300                       ,
298,297,299                       ,
303,296,304                       ,
303,311,300                       ,
304,296,298                       ,
307,301,308                       ,
310,299,301                       ,
301,300,311                       ,
312,302,313                       ,
306,298,302                       ,
302,299,310                       ,
315,319,316                       ,
318,316,319                       ,
317,316,318                       ,
322,315,323                       ,
322,330,319                       ,
323,315,317                       ,
326,320,327                       ,
329,318,320                       ,
320,319,330                       ,
331,321,332                       ,
325,317,321                       ,
321,318,329                       ,
334,340,335                       ,
337,340,334                       ,
339,335,340                       ,
341,336,342                       ,
343,334,336                       ,
336,335,344                       ,
345,338,346                       ,
347,337,338                       ,
338,334,343                       ,
348,339,349                       ,
348,344,335                       ,
349,339,337                       ,
351,355,352                       ,
354,357,352                       ,
356,353,352                       ,
332,351,341                       ,
329,355,351                       ,
351,353,343                       ,
358,354,326                       ,
359,357,354                       ,
354,355,329                       ,
346,356,360                       ,
343,353,356                       ,
356,357,359                       ,
361,365,362                       ,
364,366,365                       ,
362,365,366                       ,
368,363,358                       ,
369,361,363                       ,
363,362,359                       ,
304,364,370                       ,
304,306,366                       ,
370,364,361                       ,
360,367,312                       ,
359,362,367                       ,
367,366,306                       ,
371,377,372                       ,
374,377,371                       ,
376,372,377                       ,
378,373,345                       ,
379,371,373                       ,
373,372,347                       ,
380,375,381                       ,
382,374,375                       ,
375,371,379                       ,
349,376,383                       ,
349,347,372                       ,
383,376,374                       ,
384,388,385                       ,
387,390,385                       ,
389,386,385                       ,
313,384,378                       ,
310,388,384                       ,
384,386,379                       ,
391,387,307                       ,
392,390,387                       ,
387,388,310                       ,
381,389,393                       ,
379,386,389                       ,
389,390,392                       ,
394,398,395                       ,
397,399,398                       ,
395,398,399                       ,
401,396,391                       ,
402,394,396                       ,
396,395,392                       ,
285,397,403                       ,
285,287,399                       ,
403,397,394                       ,
393,400,293                       ,
392,395,400                       ,
400,399,287                       ,
404,410,405                       ,
407,410,404                       ,
409,405,410                       ,
411,406,380                       ,
412,404,406                       ,
406,405,382                       ,
413,408,414                       ,
415,407,408                       ,
408,404,412                       ,
383,409,416                       ,
383,382,405                       ,
416,409,407                       ,
417,421,418                       ,
420,423,418                       ,
422,419,418                       ,
294,417,411                       ,
291,421,417                       ,
417,419,412                       ,
424,420,288                       ,
425,423,420                       ,
420,421,291                       ,
414,422,426                       ,
412,419,422                       ,
422,423,425                       ,
427,431,428                       ,
430,432,431                       ,
428,431,432                       ,
434,429,424                       ,
435,427,429                       ,
429,428,425                       ,
266,430,436                       ,
266,268,432                       ,
436,430,427                       ,
426,433,274                       ,
425,428,433                       ,
433,432,268                       ,
437,443,438                       ,
440,443,437                       ,
442,438,443                       ,
444,439,413                       ,
445,437,439                       ,
439,438,415                       ,
446,441,447                       ,
448,440,441                       ,
441,437,445                       ,
416,442,449                       ,
416,415,438                       ,
449,442,440                       ,
450,454,451                       ,
453,456,451                       ,
455,452,451                       ,
275,450,444                       ,
272,454,450                       ,
450,452,445                       ,
457,453,269                       ,
458,456,453                       ,
453,454,272                       ,
447,455,459                       ,
445,452,455                       ,
455,456,458                       ,
460,464,461                       ,
463,465,464                       ,
461,464,465                       ,
467,462,457                       ,
468,460,462                       ,
462,461,458                       ,
247,463,469                       ,
247,249,465                       ,
469,463,460                       ,
459,466,255                       ,
458,461,466                       ,
466,465,249                       ,
470,476,471                       ,
473,476,470                       ,
475,471,476                       ,
477,472,446                       ,
478,470,472                       ,
472,471,448                       ,
342,474,479                       ,
344,473,474                       ,
474,470,478                       ,
449,475,348                       ,
449,448,471                       ,
348,475,473                       ,
480,484,481                       ,
483,486,481                       ,
485,482,481                       ,
256,480,477                       ,
253,484,480                       ,
480,482,478                       ,
487,483,250                       ,
488,486,483                       ,
483,484,253                       ,
479,485,489                       ,
478,482,485                       ,
485,486,488                       ,
490,494,491                       ,
493,495,494                       ,
491,494,495                       ,
497,492,487                       ,
498,490,492                       ,
492,491,488                       ,
323,493,499                       ,
323,325,495                       ,
499,493,490                       ,
489,496,331                       ,
488,491,496                       ,
496,495,325                       ,
500,506,501                       ,
503,506,500                       ,
505,501,506                       ,
507,502,508                       ,
509,500,502                       ,
502,501,510                       ,
327,504,511                       ,
330,503,504                       ,
504,500,509                       ,
512,505,322                       ,
512,510,501                       ,
322,505,503                       ,
513,517,514                       ,
516,519,514                       ,
518,515,514                       ,
237,513,507                       ,
235,517,513                       ,
513,515,509                       ,
520,516,234                       ,
521,519,516                       ,
516,517,235                       ,
511,518,522                       ,
509,515,518                       ,
518,519,521                       ,
523,527,524                       ,
526,528,527                       ,
524,527,528                       ,
530,525,520                       ,
531,523,525                       ,
525,524,521                       ,
370,526,532                       ,
370,369,528                       ,
532,526,523                       ,
522,529,368                       ,
521,524,529                       ,
529,528,369                       ,
533,539,534                       ,
536,539,533                       ,
538,534,539                       ,
540,535,541                       ,
542,533,535                       ,
535,534,543                       ,
308,537,544                       ,
311,536,537                       ,
537,533,542                       ,
545,538,303                       ,
545,543,534                       ,
303,538,536                       ,
546,550,547                       ,
549,552,547                       ,
551,548,547                       ,
223,546,540                       ,
221,550,546                       ,
546,548,542                       ,
553,549,220                       ,
554,552,549                       ,
549,550,221                       ,
544,551,555                       ,
542,548,551                       ,
551,552,554                       ,
556,560,557                       ,
559,561,560                       ,
557,560,561                       ,
563,558,553                       ,
564,556,558                       ,
558,557,554                       ,
403,559,565                       ,
403,402,561                       ,
565,559,556                       ,
555,562,401                       ,
554,557,562                       ,
562,561,402                       ,
566,572,567                       ,
569,572,566                       ,
571,567,572                       ,
573,568,574                       ,
575,566,568                       ,
568,567,576                       ,
289,570,577                       ,
292,569,570                       ,
570,566,575                       ,
578,571,284                       ,
578,576,567                       ,
284,571,569                       ,
579,583,580                       ,
582,585,580                       ,
584,581,580                       ,
209,579,573                       ,
207,583,579                       ,
579,581,575                       ,
586,582,206                       ,
587,585,582                       ,
582,583,207                       ,
577,584,588                       ,
575,581,584                       ,
584,585,587                       ,
589,593,590                       ,
592,594,593                       ,
590,593,594                       ,
596,591,586                       ,
597,589,591                       ,
591,590,587                       ,
436,592,598                       ,
436,435,594                       ,
598,592,589                       ,
588,595,434                       ,
587,590,595                       ,
595,594,435                       ,
599,605,600                       ,
602,605,599                       ,
604,600,605                       ,
606,601,607                       ,
608,599,601                       ,
601,600,609                       ,
270,603,610                       ,
273,602,603                       ,
603,599,608                       ,
611,604,265                       ,
611,609,600                       ,
265,604,602                       ,
612,616,613                       ,
615,618,613                       ,
617,614,613                       ,
195,612,606                       ,
193,616,612                       ,
612,614,608                       ,
619,615,192                       ,
620,618,615                       ,
615,616,193                       ,
610,617,621                       ,
608,614,617                       ,
617,618,620                       ,
622,626,623                       ,
625,627,626                       ,
623,626,627                       ,
629,624,619                       ,
630,622,624                       ,
624,623,620                       ,
469,625,631                       ,
469,468,627                       ,
631,625,622                       ,
621,628,467                       ,
620,623,628                       ,
628,627,468                       ,
632,638,633                       ,
635,638,632                       ,
637,633,638                       ,
639,634,640                       ,
641,632,634                       ,
634,633,642                       ,
251,636,643                       ,
254,635,636                       ,
636,632,641                       ,
644,637,246                       ,
644,642,633                       ,
246,637,635                       ,
645,649,646                       ,
648,651,646                       ,
650,647,646                       ,
181,645,639                       ,
179,649,645                       ,
645,647,641                       ,
652,648,178                       ,
653,651,648                       ,
648,649,179                       ,
643,650,654                       ,
641,647,650                       ,
650,651,653                       ,
655,659,656                       ,
658,660,659                       ,
656,659,660                       ,
662,657,652                       ,
663,655,657                       ,
657,656,653                       ,
499,658,664                       ,
499,498,660                       ,
664,658,655                       ,
654,661,497                       ,
653,656,661                       ,
661,660,498                       ,
665,671,666                       ,
668,671,665                       ,
670,666,671                       ,
672,667,530                       ,
673,665,667                       ,
667,666,531                       ,
541,669,674                       ,
543,668,669                       ,
669,665,673                       ,
532,670,545                       ,
532,531,666                       ,
545,670,668                       ,
675,679,676                       ,
678,681,676                       ,
680,677,676                       ,
167,675,672                       ,
164,679,675                       ,
675,677,673                       ,
682,678,161                       ,
683,681,678                       ,
678,679,164                       ,
674,680,684                       ,
673,677,680                       ,
680,681,683                       ,
685,689,686                       ,
688,690,689                       ,
686,689,690                       ,
692,687,682                       ,
693,685,687                       ,
687,686,683                       ,
218,688,694                       ,
218,219,690                       ,
694,688,685                       ,
684,691,222                       ,
683,686,691                       ,
691,690,219                       ,
695,701,696                       ,
698,701,695                       ,
700,696,701                       ,
702,697,563                       ,
703,695,697                       ,
697,696,564                       ,
574,699,704                       ,
576,698,699                       ,
699,695,703                       ,
565,700,578                       ,
565,564,696                       ,
578,700,698                       ,
705,709,706                       ,
708,711,706                       ,
710,707,706                       ,
148,705,702                       ,
145,709,705                       ,
705,707,703                       ,
712,708,142                       ,
713,711,708                       ,
708,709,145                       ,
704,710,714                       ,
703,707,710                       ,
710,711,713                       ,
715,719,716                       ,
718,720,719                       ,
716,719,720                       ,
722,717,712                       ,
723,715,717                       ,
717,716,713                       ,
204,718,724                       ,
204,205,720                       ,
724,718,715                       ,
714,721,208                       ,
713,716,721                       ,
721,720,205                       ,
725,731,726                       ,
728,731,725                       ,
730,726,731                       ,
732,727,596                       ,
733,725,727                       ,
727,726,597                       ,
607,729,734                       ,
609,728,729                       ,
729,725,733                       ,
598,730,611                       ,
598,597,726                       ,
611,730,728                       ,
735,739,736                       ,
738,741,736                       ,
740,737,736                       ,
129,735,732                       ,
126,739,735                       ,
735,737,733                       ,
742,738,123                       ,
743,741,738                       ,
738,739,126                       ,
734,740,744                       ,
733,737,740                       ,
740,741,743                       ,
745,749,746                       ,
748,750,749                       ,
746,749,750                       ,
752,747,742                       ,
753,745,747                       ,
747,746,743                       ,
190,748,754                       ,
190,191,750                       ,
754,748,745                       ,
744,751,194                       ,
743,746,751                       ,
751,750,191                       ,
755,761,756                       ,
758,761,755                       ,
760,756,761                       ,
762,757,629                       ,
763,755,757                       ,
757,756,630                       ,
640,759,764                       ,
642,758,759                       ,
759,755,763                       ,
631,760,644                       ,
631,630,756                       ,
644,760,758                       ,
765,769,766                       ,
768,771,766                       ,
770,767,766                       ,
110,765,762                       ,
107,769,765                       ,
765,767,763                       ,
772,768,104                       ,
773,771,768                       ,
768,769,107                       ,
764,770,774                       ,
763,767,770                       ,
770,771,773                       ,
775,779,776                       ,
778,780,779                       ,
776,779,780                       ,
782,777,772                       ,
783,775,777                       ,
777,776,773                       ,
176,778,784                       ,
176,177,780                       ,
784,778,775                       ,
774,781,180                       ,
773,776,781                       ,
781,780,177                       ,
785,791,786                       ,
788,791,785                       ,
790,786,791                       ,
792,787,662                       ,
793,785,787                       ,
787,786,663                       ,
508,789,794                       ,
510,788,789                       ,
789,785,793                       ,
664,790,512                       ,
664,663,786                       ,
512,790,788                       ,
795,799,796                       ,
798,801,796                       ,
800,797,796                       ,
91,795,792                        ,
89,799,795                        ,
795,797,793                       ,
802,798,88                        ,
803,801,798                       ,
798,799,89                        ,
794,800,804                       ,
793,797,800                       ,
800,801,803                       ,
805,809,806                       ,
808,810,809                       ,
806,809,810                       ,
812,807,802                       ,
813,805,807                       ,
807,806,803                       ,
232,808,814                       ,
232,233,810                       ,
814,808,805                       ,
804,811,236                       ,
803,806,811                       ,
811,810,233                       ,
815,821,816                       ,
818,821,815                       ,
820,816,821                       ,
822,817,823                       ,
824,815,817                       ,
817,816,825                       ,
162,819,826                       ,
165,818,819                       ,
819,815,824                       ,
827,820,157                       ,
827,825,816                       ,
157,820,818                       ,
828,832,829                       ,
831,834,829                       ,
833,830,829                       ,
77,828,822                        ,
75,832,828                        ,
828,830,824                       ,
835,831,74                        ,
836,834,831                       ,
831,832,75                        ,
826,833,837                       ,
824,830,833                       ,
833,834,836                       ,
838,842,839                       ,
841,843,842                       ,
839,842,843                       ,
845,840,835                       ,
846,838,840                       ,
840,839,836                       ,
694,841,847                       ,
694,693,843                       ,
847,841,838                       ,
837,844,692                       ,
836,839,844                       ,
844,843,693                       ,
848,854,849                       ,
851,854,848                       ,
853,849,854                       ,
855,850,845                       ,
856,848,850                       ,
850,849,846                       ,
143,852,857                       ,
146,851,852                       ,
852,848,856                       ,
847,853,138                       ,
847,846,849                       ,
138,853,851                       ,
858,862,859                       ,
861,864,859                       ,
863,860,859                       ,
63,858,855                        ,
61,862,858                        ,
858,860,856                       ,
865,861,60                        ,
866,864,861                       ,
861,862,61                        ,
857,863,867                       ,
856,860,863                       ,
863,864,866                       ,
868,872,869                       ,
871,873,872                       ,
869,872,873                       ,
875,870,865                       ,
876,868,870                       ,
870,869,866                       ,
724,871,877                       ,
724,723,873                       ,
877,871,868                       ,
867,874,722                       ,
866,869,874                       ,
874,873,723                       ,
878,884,879                       ,
881,884,878                       ,
883,879,884                       ,
885,880,875                       ,
886,878,880                       ,
880,879,876                       ,
124,882,887                       ,
127,881,882                       ,
882,878,886                       ,
877,883,119                       ,
877,876,879                       ,
119,883,881                       ,
888,892,889                       ,
891,894,889                       ,
893,890,889                       ,
49,888,885                        ,
47,892,888                        ,
888,890,886                       ,
895,891,46                        ,
896,894,891                       ,
891,892,47                        ,
887,893,897                       ,
886,890,893                       ,
893,894,896                       ,
898,902,899                       ,
901,903,902                       ,
899,902,903                       ,
905,900,895                       ,
906,898,900                       ,
900,899,896                       ,
754,901,907                       ,
754,753,903                       ,
907,901,898                       ,
897,904,752                       ,
896,899,904                       ,
904,903,753                       ,
908,914,909                       ,
911,914,908                       ,
913,909,914                       ,
915,910,812                       ,
916,908,910                       ,
910,909,813                       ,
823,912,917                       ,
825,911,912                       ,
912,908,916                       ,
814,913,827                       ,
814,813,909                       ,
827,913,911                       ,
918,922,919                       ,
921,924,919                       ,
923,920,919                       ,
35,918,915                        ,
32,922,918                        ,
918,920,916                       ,
925,921,30                        ,
926,924,921                       ,
921,922,32                        ,
917,923,927                       ,
916,920,923                       ,
923,924,926                       ,
928,932,929                       ,
931,933,932                       ,
929,932,933                       ,
12,930,925                        ,
15,928,930                        ,
930,929,926                       ,
72,931,7                          ,
72,73,933                         ,
7,931,928                         ,
927,934,76                        ,
926,929,934                       ,
934,933,73                        ,
935,941,936                       ,
938,941,935                       ,
940,936,941                       ,
942,937,905                       ,
943,935,937                       ,
937,936,906                       ,
105,939,944                       ,
108,938,939                       ,
939,935,943                       ,
907,940,100                       ,
907,906,936                       ,
100,940,938                       ,
945,949,946                       ,
948,951,946                       ,
950,947,946                       ,
17,945,942                        ,
14,949,945                        ,
945,947,943                       ,
952,948,11                        ,
953,951,948                       ,
948,949,14                        ,
944,950,954                       ,
943,947,950                       ,
950,951,953                       ,
955,959,956                       ,
958,960,959                       ,
956,959,960                       ,
31,957,952                        ,
33,955,957                        ,
957,956,953                       ,
784,958,26                        ,
784,783,960                       ,
26,958,955                        ,
954,961,782                       ,
953,956,961                       ,
961,960,783
		},
		{glm::vec4(1)}
	);
	spherical_gaussian.set_descriptor_bindings(uniform_buffers);
	cleanup_queue.add(&spherical_gaussian);



	// terrain needs directional light to be initiated due to it relying on it's uniform buffer
	terrain.init(
		device,
		get_current_graphics_pool(),
		get_current_transfer_pool(),
		descriptor_pool,
		&mirror_texture_sampler,
		&shared_terrain_data,

		"textures/terrain/heightmap.png",
		//"textures/terrain/test/height_test4.png",
		"textures/terrain/texture.png",
		"textures/terrain/normal.png",
		256							// resolution of mesh
	);
	terrain.set_descriptor_bindings(uniform_buffers, directional_light.get_uniform_buffers(), directional_light.get_texture(), linear_texture_sampler);
	cleanup_queue.add(&terrain);

	environment_map.init(
		device,
		get_current_graphics_pool(),
		get_current_transfer_pool(),
		descriptor_pool,
		&shared_environment_data,

		"textures/environment_maps/day_cube_map_%.exr"
		//"textures/environment_maps/rogland_clear_night_%.exr"
		//"textures/environment_maps/test/test_%.exr"
	);
	environment_map.set_descriptor_bindings(uniform_buffers, linear_texture_sampler);
	cleanup_queue.add(&environment_map);
}

void Engine::create_texture_samplers()
{
	linear_texture_sampler.init(&device, "Default sampler");
	cleanup_queue.add(&linear_texture_sampler);

	nearest_texture_sampler.set_min_filter(VK_FILTER_NEAREST);
	nearest_texture_sampler.set_mag_filter(VK_FILTER_NEAREST);
	nearest_texture_sampler.init(&device, "Nearest neighbour sampler");
	cleanup_queue.add(&nearest_texture_sampler);

	mirror_texture_sampler.set_address_mode(VK_SAMPLER_ADDRESS_MODE_MIRRORED_REPEAT);
	mirror_texture_sampler.init(&device, "Repeat sampler");
	cleanup_queue.add(&mirror_texture_sampler);
}

void Engine::create_descriptor_sets()
{
	imgui_descriptor_pool.add_type(VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER, 1);
	imgui_descriptor_pool.init(&device, 1, "Imgui descriptor pool");
	cleanup_queue.add(&imgui_descriptor_pool);
	
	// each Terrain instance needs MAX_FRAMES_IN_FLIGHT many descriptor sets
	descriptor_pool.add_layout(shared_terrain_data.get_descriptor_set_layout(), MAX_FRAMES_IN_FLIGHT);
	descriptor_pool.add_layout(shared_environment_data.get_descriptor_set_layout(), MAX_FRAMES_IN_FLIGHT);
	descriptor_pool.add_layout(shared_line_data.get_descriptor_set_layout(), MAX_FRAMES_IN_FLIGHT*3*MAX_CASCADE_COUNT);

	descriptor_pool.init(&device, MAX_FRAMES_IN_FLIGHT*(2 + 3 * MAX_CASCADE_COUNT), "General descriptor pool");
	cleanup_queue.add(&descriptor_pool);
}

void Engine::create_uniform_buffers()
{
	for (VKW_Buffer& uniform_buffer : uniform_buffers) {
		uniform_buffer.init(
			&device, 
			sizeof(UniformStruct), 
			VK_BUFFER_USAGE_UNIFORM_BUFFER_BIT, 
			sharing_exlusive(), 
			true,
			"Main Uniform buffer"
		);
		uniform_buffer.map();
		cleanup_queue.add(&uniform_buffer);
	}
}

void Engine::init_render_targets()
{
	color_render_target.init(
		&device,
		swapchain.get_extent().width,
		swapchain.get_extent().height,
		Texture::find_format(device, Texture_Type::Tex_Colortarget),
		VK_IMAGE_USAGE_TRANSFER_SRC_BIT | VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT,
		sharing_exlusive(),
		"Color render target"
	); // TODO: FIX might add it multiple times to the clean up queue	
	cleanup_queue.add(&color_render_target);

	depth_render_target.init(
		&device,
		swapchain.get_extent().width,
		swapchain.get_extent().height,
		Texture::find_format(device, Texture_Type::Tex_D),
		VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT,
		sharing_exlusive(),
		"Depth render target"
	);
	cleanup_queue.add(&depth_render_target);
}

void Engine::create_graphics_pipelines()
{
	for (int i = 0; i < MAX_CASCADE_COUNT; i++) {
		terrain_pipelines.at(i) = Terrain::create_pipeline(&device, color_render_target, depth_render_target, shared_terrain_data, false, false, false, i+1);
		cleanup_queue.add(&terrain_pipelines.at(i));

		terrain_wireframe_pipelines.at(i) = Terrain::create_pipeline(&device, color_render_target, depth_render_target, shared_terrain_data, false, true, false, i+1); // wireframe but not depth only
		cleanup_queue.add(&terrain_wireframe_pipelines.at(i));
	}
	

	terrain_depth_pipeline = Terrain::create_pipeline(&device, color_render_target, depth_render_target, shared_terrain_data, true, false, true);
	cleanup_queue.add(&terrain_depth_pipeline);

	environment_map_pipeline = EnvironmentMap::create_pipeline(&device, color_render_target, depth_render_target, shared_environment_data);
	cleanup_queue.add(&environment_map_pipeline);

	line_pipeline = Line::create_pipeline(&device, color_render_target, depth_render_target, shared_line_data);
	cleanup_queue.add(&line_pipeline);
}

void Engine::create_swapchain()
{
	swapchain.init(window, device, &present_queue, "Swapchain");
	cleanup_queue.add(&swapchain);

	init_render_targets();
}

void Engine::recreate_swapchain()
{
	// dont recreate swapchain while image is minimized
	int width, height;
	glfwGetFramebufferSize(window, &width, &height);
	while (width == 0 || height == 0) {
		glfwGetFramebufferSize(window, &width, &height);
		glfwWaitEvents();
	}
	res_x = width;
	res_y = height;

	vkDeviceWaitIdle(device);

	swapchain.recreate(window, device);

	recreate_render_targets();

	camera.set_aspect_ratio(res_x, res_y);
}

void Engine::recreate_render_targets()
{
	// Destroys render targets

	color_render_target.del();
	depth_render_target.del();

	// important to clear i.e. image view cache
	color_render_target = {};
	depth_render_target = {};

	init_render_targets();
}

void Engine::create_command_structs()
{
	// Use 1 command pool with one buffer per thread and image in flight
	for (unsigned int i = 0; i < MAX_FRAMES_IN_FLIGHT; i++) {
		command_structs.at(i) = {
			{},
			{},
			{},
		};

		command_structs.at(i).graphics_command_pool.init(&device, &graphics_queue, VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT, "Graphics pool");
		cleanup_queue.add(&command_structs.at(i).graphics_command_pool);
		
		command_structs.at(i).transfer_command_pool.init(&device, &transfer_queue, VK_COMMAND_POOL_CREATE_TRANSIENT_BIT, "Transfer pool");
		cleanup_queue.add(&command_structs.at(i).transfer_command_pool);
		
		command_structs.at(i).graphics_command_buffer.init(&device, &command_structs.at(i).graphics_command_pool, false, "Draw CMD");
	}
}

void Engine::create_sync_structs()
{
	// TODO: look into Semaphore/Fence pool
	VkSemaphoreCreateInfo semaphore_create_info{};
	semaphore_create_info.sType = VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO;

	VkFenceCreateInfo fence_create_info{};
	fence_create_info.sType = VK_STRUCTURE_TYPE_FENCE_CREATE_INFO;
	fence_create_info.flags = VK_FENCE_CREATE_SIGNALED_BIT; // start in signaled state

	for (unsigned int i = 0; i < MAX_FRAMES_IN_FLIGHT; i++) {
		sync_structs.at(i) = {};
		VK_CHECK_E(vkCreateSemaphore(device, &semaphore_create_info, nullptr, &sync_structs.at(i).swapchain_semaphore), SetupException);
		VK_CHECK_E(vkCreateSemaphore(device, &semaphore_create_info, nullptr, &sync_structs.at(i).render_semaphore), SetupException);
		VK_CHECK_E(vkCreateFence(device, &fence_create_info, nullptr, &sync_structs.at(i).render_fence), SetupException);

		device.name_object((uint64_t)sync_structs.at(i).swapchain_semaphore, VK_OBJECT_TYPE_SEMAPHORE, "Swapchain semaphore");
		device.name_object((uint64_t)sync_structs.at(i).render_semaphore, VK_OBJECT_TYPE_SEMAPHORE, "Render semaphore");
		device.name_object((uint64_t)sync_structs.at(i).render_fence, VK_OBJECT_TYPE_FENCE, "Render fence");
	}
}

bool Engine::aquire_image()
{
	VkFence render_fence = get_current_render_fence();
	VK_CHECK_E(vkWaitForFences(device, 1, &render_fence, VK_TRUE, UINT64_MAX), RuntimeException);
	
	VkResult aquire_image_result = vkAcquireNextImageKHR(
		device, 
		swapchain,
		UINT64_MAX, 
		get_current_swapchain_semaphore(),
		VK_NULL_HANDLE, 
		&current_swapchain_image_idx
	);
	if (aquire_image_result == VK_ERROR_OUT_OF_DATE_KHR) {
		std::cout << "Recreate swapchain (Aquire)" << std::endl;
		resize_window = true;

		return false;
	}
	else if (aquire_image_result != VK_SUCCESS && aquire_image_result != VK_SUBOPTIMAL_KHR) {
		throw RuntimeException("Failed to aquire image from swapchain: " + std::string(string_VkResult(aquire_image_result)), __FILE__, __LINE__);
	}
	
	// we have successfully aquired image, can reset fence
	VK_CHECK_E(vkResetFences(device, 1, &render_fence), RuntimeException);

	return true;
}

void Engine::update_uniforms()
{
	UniformStruct uniform{};
	uniform.proj = camera.generate_projection_mat();
	uniform.proj[1][1] *= -1; // see https://community.khronos.org/t/confused-when-using-glm-for-projection/108548/2 for reason for the multiplication

	uniform.view = camera.generate_view_mat();
	uniform.inv_view = glm::inverse(uniform.view);
	uniform.virtual_view = camera.generate_virtual_view_mat();

	uniform.near_far_plane = glm::vec2(camera.get_near_plane(), camera.get_far_plane());
	
	uniform.sun_direction = directional_light.get_direction();
	uniform.sun_color = directional_light.get_color();
	
	memcpy(uniform_buffers.at(current_frame).get_mapped_address(), &uniform, sizeof(UniformStruct));
}

std::vector<const char*> Engine::get_required_instance_extensions()
{
	uint32_t glfwExtensionCount = 0;
	const char** glfwExtensions;

	glfwExtensions = glfwGetRequiredInstanceExtensions(&glfwExtensionCount);

	std::vector<const char*> extensions(glfwExtensions, glfwExtensions + glfwExtensionCount);
	extensions.push_back("VK_EXT_debug_utils");

	return extensions;
}

std::vector<const char*> Engine::get_required_device_extensions()
{
	// VK_KHR_SWAPCHAIN_EXTENSION_NAME is added automatically
	std::vector<const char*> extensions{};
	return extensions;
}

Required_Device_Features Engine::get_required_device_features()
{
	Required_Device_Features features{};
	// 1.0 features
	features.rf.samplerAnisotropy = true;
	features.rf.fillModeNonSolid = true;
	features.rf.tessellationShader = true;
	// 1.2 features
	features.rf12.bufferDeviceAddress = true;
	features.rf12.descriptorIndexing = true;
	// 1.3 features
	features.rf13.dynamicRendering = true;
	features.rf13.synchronization2 = true;

	return features;
}

void glfm_mouse_move_callback(GLFWwindow* window, double pos_x, double pos_y) {
	Engine* engine = reinterpret_cast<Engine*>(glfwGetWindowUserPointer(window));
	if (engine) {
		engine->camera_controller.handle_mouse(pos_x, pos_y);
	}
	else {
		throw SetupException("GLFW Engine User pointer not set", __FILE__, __LINE__);
	}
}